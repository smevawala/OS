%!PS-Adobe-3.0
%%Creator: groff version 1.19.1
%%CreationDate: Fri Nov  1 01:02:02 2013
%%DocumentNeededResources: font Times-Roman
%%+ font Times-Bold
%%+ font Courier
%%+ font Times-Italic
%%DocumentSuppliedResources: file tcpseq.eps
%%+ file tcpbuffers.eps
%%+ file tcpest.eps
%%+ file tcpstate.eps
%%+ file tcppkt.eps
%%+ file udppkt.eps
%%+ file ippkt.eps
%%+ procset grops 1.19 1
%%Pages: 21
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.19 1
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/Fr{
setrgbcolor fill
}bind def
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
/Fg{
setgray fill
}bind def
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
/setpagedevice{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
%%IncludeResource: font Times-Bold
%%IncludeResource: font Courier
%%IncludeResource: font Times-Italic
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Times-Italic@0 ENC0/Times-Italic RE/Courier@0 ENC0/Courier RE
/Times-Bold@0 ENC0/Times-Bold RE/Times-Roman@0 ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)69.336 60 Q
(Unit 6/pg 1)55.998 E(\2512013 Jef)126.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Bold@0 SF(Inter)169.309 120 Q(pr)-.13 E
(ocess Communication \(IPC\))-.234 E/F2 13/Times-Roman@0 SF 3.954(Ap)
33.336 150 S .704(rocess is of little use if it is unable to communicat\
e with other processes \(and users\).)-3.954 F 1.257(There are man)
33.336 165 R 4.507(yf)-.195 G 1.257(orms of IPC in UNIX.)-4.507 F 3.338
-1.04(We h)7.758 H -2.925 -.26(av e)1.04 H 1.258(already seen ho)4.768 F
4.508(wp)-.325 G 1.258(ipes \(and "named)-4.508 F 1.963
(pipes"\) can be used to connect processes to form a pipeline.)33.336
180 R 1.963(UNIX also pro)8.463 F 1.963(vides the)-.195 F F1 2.02
(System V IPC)33.336 195 R F2 2.021(mechanisms of shared memory)5.271 F
5.271(,m)-.845 G 2.021(essage queues and IPC semaphores.)-5.271 F .323
(These are all some)33.336 210 R .323
(what dated and cumbersome, although the)-.325 F 3.573(ya)-.195 G .323
(re still sometimes used in)-3.573 F(ne)33.336 225 Q 4.104(wc)-.325 G
4.104(ode. A)-4.104 F(ne)4.104 E .855
(wer message queues implementation w)-.325 F .855
(as standardized by POSIX and is)-.13 F -.26(av)33.336 240 S
(ailable on recent UNIX v)-.065 E(ersions; it is e)-.195 E -.195(ve)
-.325 G 3.25(nl).195 G(ess popular than SystemV IPC.)-3.25 E 1.325
(All of the abo)33.336 270 R 1.714 -.195(ve I)-.195 H 1.324
(PC methods are limited to processes e).195 F -.195(xe)-.195 G 1.324
(cuting on the same machine.).195 F 1.111(Under UNIX, the)33.336 285 R
F1(sock)4.361 E 1.111(et lay)-.13 F(er)-.13 E F2(pro)4.361 E 1.112
(vides access to netw)-.195 F 1.112(ork protocols which can connect)-.13
F 2.151(processes on dif)33.336 300 R 2.151(ferent machines.)-.325 F
2.151(Through sock)8.651 F 2.151(et programming, the same API can be)
-.13 F(used re)33.336 315 Q -.065(ga)-.195 G(rdless of whether the tar)
.065 E(get process is local or remote.)-.234 E 1.199(The sock)33.336 345
R 1.199(et layer can be used with a wide v)-.13 F 1.2(ariety of netw)
-.325 F 1.2(orking protocols.)-.13 F 1.2(In this unit,)7.7 F .417
(we will consider the application of sock)33.336 360 R .417
(ets to the internet.)-.13 F .417(It is important to note that the)6.917
F(sock)33.336 375 Q .119(ets API can be used to access a number of netw)
-.13 F .12(orking protocols, and that the internet)-.13 F .303
(protocols described in this unit are not de\214ned by the sock)33.336
390 R .302(ets API, and could be accessed)-.13 F 1.75(by other interf)
33.336 405 R 5(aces. Ho)-.13 F(we)-.325 E -.195(ve)-.325 G 2.79 -.52
(r, t).195 H 1.75(his particular combination of sock).52 F 1.751
(ets and the "TCP/IP")-.13 F(internet protocol suite is v)33.336 420 Q
(ery popular and basis for man)-.195 E 3.25(ya)-.195 G
(pplications and services.)-3.25 E F1(What is the)209.661 450 Q(Inter)
6.5 E(net)-.195 E F2 .837(The roots of the)33.336 486 R F1(Inter)4.087 E
(net)-.195 E F2 .836
(trace back to about 1969, although the protocols that form the)4.087 F
(basis of today')33.336 501 Q 3.25(si)-.715 G(nternet did not emer)-3.25
E(ge until the early 1980s.)-.234 E 3.257
(At its simplest, the internet is a loose collection of pri)33.336 522 R
-.325(va)-.325 G 3.257(te netw).325 F 3.257(orks, sharing some)-.13 F
2.689(common protocols and polic)33.336 537 R 5.939(yc)-.195 G(on)-5.939
E -.195(ve)-.52 G 5.938(ntions. This).195 F(allo)5.938 E 2.688
(ws computers and other de)-.325 F(vices)-.325 E 3.116
(connected to these netw)33.336 552 R 3.116(orks to e)-.13 F 3.116
(xchange data with each other and to participate in)-.195 F(distrib)
33.336 567 Q 1.53(uted applications.)-.26 F 1.53
(This same technology can be used both on the global internet)8.03 F
(and within pri)33.336 582 Q -.325(va)-.325 G(te netw).325 E
(orks in so-called "intra-net" applications.)-.13 E .137
(The basic service pro)33.336 603 R .137(vided by the Internet is kno)
-.195 F .137(wn as Internet Protocol, or IP)-.325 F 6.637(.I)-1.443 G
3.387(Ps)-6.637 G(ervice)-3.387 E 4.466
(is roughly analogous to the Postal Service.)33.336 618 R 4.465
(Messages, kno)10.965 F 4.465(wn as)-.325 F F1 4.465(IP pack)7.715 F
(ets)-.13 E F2(are)7.715 E 2.576
(addressed to their destination by means of a unique 32 bit inte)33.336
633 R(ger)-.195 E 5.827(,k)-.52 G(no)-5.827 E 2.577(wn as the)-.325 F F1
(IP)5.827 E(addr)33.336 648 Q(ess)-.234 E F2 6.5(.E)C(ach pack)-6.5 E
(et bears both the destination and the source \("return"\) address.)-.13
E 1.97(The IP address identi\214es hosts within the Internet.)33.336 669
R 1.969(As with b)8.469 F 1.969(uildings ha)-.26 F 1.969(ving multiple)
-.26 F 2.021(street entrances and thus multiple Postal addresses, it is\
 possible for one host to ha)33.336 684 R -.195(ve)-.26 G
(multiple IP addresses, for e)33.336 699 Q
(xample, if it is connected to multiple netw)-.195 E(orks.)-.13 E 4.143
(IP addresses are represented in)33.336 720 R F1 4.142
(dotted decimal notation)7.392 F F2 7.392(,c)C 4.142
(onsisting of 4 decimal)-7.392 F 2.338(numbers representing the four by\
tes of the 32 bit address, delimited by periods, e.g.,)33.336 735 R 0 Cg
EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 2)73.998 E(\2512013 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Courier@0 SF(192.168.4.5)33.336 120 Q/F2 13/Times-Roman@0 SF
.507(All numeric v)3.757 F .507(alues in the Internet protocols are in)
-.325 F/F3 13/Times-Bold@0 SF(netw)3.757 E .507(ork byte order)-.13 F F2
(,)A(which is de\214ned to be big-endian.)33.336 135 Q .612
(The allocation of IP addresses and their manipulation is be)33.336 156
R .612(yond the scope of this course.)-.195 F 1.959
(Consider the IP address to be just a unique identi\214er)33.336 171 R
8.459(.T)-.715 G 1.959(here is, ho)-8.459 F(we)-.325 E -.195(ve)-.325 G
2.999 -.52(r, o).195 H 1.959(ne address).52 F(which is reserv)33.336 186
Q(ed to be an alias for the local host:)-.195 E F1(127.0.0.1)3.25 E F2
(.)A .99(Each IP pack)33.336 207 R .991
(et is self-contained and is stateless, i.e. there is no dependenc)-.13
F 4.241(yo)-.195 G 4.241(no)-4.241 G .991(ther IP)-4.241 F(pack)33.336
222 Q 2.967(ets sent earlier or later)-.13 F 9.466(.T)-.715 G 2.966
(he destination address contains all of the information)-9.466 F 2.831
(necessary to deli)33.336 237 R -.195(ve)-.325 G 6.081(rt).195 G 2.831
(he message.)-6.081 F 2.831(That task is gi)9.331 F -.195(ve)-.325 G
6.081(nt).195 G 6.081(od)-6.081 G 2.831(edicated de)-6.081 F 2.831
(vices kno)-.325 F 2.831(wn as)-.325 F F3 -.234(ro)33.336 252 S(uters)
.234 E F2(.)A 0 0 110 110 -231 231 212.336 504 PBEGIN
%%BeginDocument: ippkt.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: ippkt.eps
%%Creator: fig2dev Version 3.2 Patchlevel 1
%%CreationDate: Fri Feb 26 21:10:22 1999
%%For: hak@astor.cooper.edu (hak)
%%Orientation: Portrait
%%BoundingBox: 0 0 110 231
%%Pages: 0
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-215.0 289.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n -1000 5812 m -1000 -1000 l 6412 -1000 l 6412 5812 l cp clip
 0.06000 0.06000 sc
% Polyline
7.500 slw
n 3600 1200 m 5400 1200 l 5400 1800 l 3600 1800 l cp gs col0 s gr 
% Polyline
n 3600 1800 m 5400 1800 l 5400 2400 l 3600 2400 l cp gs col0 s gr 
% Polyline
n 3600 2400 m 5400 2400 l 5400 2700 l 3600 2700 l cp gs col0 s gr 
% Polyline
n 3600 2700 m 5400 2700 l 5400 3000 l 3600 3000 l cp gs col0 s gr 
% Polyline
n 3600 3000 m 5400 3000 l 5400 4800 l 3600 4800 l cp gs col0 s gr 
/Times-Roman ff 210.00 scf sf
4425 1425 m
gs 1 -1 sc (Destination) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4425 1680 m
gs 1 -1 sc (IP Address) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2025 m
gs 1 -1 sc (Source) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2280 m
gs 1 -1 sc (IP Address) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2625 m
gs 1 -1 sc (Payload protocol) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2925 m
gs 1 -1 sc (Other headers) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 3900 m
gs 1 -1 sc (PAYLOAD) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4425 1125 m
gs 1 -1 sc (An IP Packet) dup sw pop 2 div neg 0 rm  col0 sh gr
$F2psEnd
rs
%%EndDocument
end PEND .379(Message boundaries are preserv)33.336 531 R 3.629(ed. IP)
-.195 F .379(does not, as a rule, deli)3.629 F -.195(ve)-.325 G 3.629
(rap).195 G .378(artial pack)-3.629 F 3.628(et. Either)-.13 F .519
(the entire pack)33.336 546 R .519(et is deli)-.13 F -.195(ve)-.325 G
.519(red, or it is lost.).195 F 3.769(Am)7.019 G .519(essage is ne)
-3.769 F -.195(ve)-.325 G 3.769(rs).195 G .52(plit up and deli)-3.769 F
-.195(ve)-.325 G .52(red as a).195 F .886(series of smaller messages \(\
although this splitting may be performed internally)33.336 561 R 4.136
(,t)-.845 G .886(he split)-4.136 F 2.398(messages are ne)33.336 576 R
-.195(ve)-.325 G 5.648(rd).195 G(eli)-5.648 E -.195(ve)-.325 G 2.399
(red as such\), nor are multiple messages e).195 F -.195(ve)-.325 G
5.649(rc).195 G 2.399(oalesced and)-5.649 F(deli)33.336 591 Q -.195(ve)
-.325 G(red as one.).195 E(Lik)33.336 621 Q 3.25(et)-.13 G
(he Postal Service, IP pro)-3.25 E(vides "best ef)-.195 E
(fort, unreliable" deli)-.325 E -.195(ve)-.325 G(ry:).195 E 3.25<8350>
33.336 636 S(ack)-3.445 E(ets may be lost in transit, in f)-.13 E
(act, that is a common occurrence.)-.13 E 3.25<8354>33.336 651 S
(he latenc)-3.25 E 3.25(yi)-.195 G(ncurred in deli)-3.25 E -.195(ve)
-.325 G(ring a pack).195 E(et is unpredictable and unguaranteed.)-.13 E
3.25<8350>33.336 666 S(ack)-3.445 E(ets may be deli)-.13 E -.195(ve)
-.325 G(red out of order).195 E(.)-.715 E 5.989<8350>33.336 681 S(ack)
-6.184 E 2.739(ets may be deli)-.13 F -.195(ve)-.325 G 2.739
(red in damaged condition \(the message has been corrupted\),).195 F(ho)
33.336 696 Q(we)-.325 E -.195(ve)-.325 G 4.353(rt).195 G 1.103
(his is not that common an occurence since most link-layers guard ag)
-4.353 F 1.103(ainst line)-.065 F(errors.)33.336 711 Q F3
(UDP and port numbers)202.154 741 Q 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 3)73.998 E(\2512013 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Roman@0 SF 2.145
(IP addresses refer to speci\214c hosts on the Internet.)33.336 120 R
2.145(Since there are typically multiple)8.645 F 6.506
(processes utilizing services on the same machine,)33.336 135 R/F2 13
/Times-Bold@0 SF 6.506(port numbers)9.756 F F1 6.506(are used to)9.756 F
1.878(disambiguate and create an array of, as it were, mailbox)33.336
150 R 1.877(es within a single machine in)-.195 F
(which processes can recei)33.336 165 Q .39 -.195(ve m)-.325 H(essages.)
.195 E(The)33.336 186 Q F2 1.276(User Datagram Pr)4.526 F(otocol)-.234 E
F1 1.277(is a simple wrapper around IP)4.527 F 7.777(.I)-1.443 G 4.527
(tp)-7.777 G(ro)-4.527 E 1.277(vides a source and)-.195 F .412
(destination port number \(16 bit inte)33.336 201 R .411
(ger\) which, combined with the source and destination)-.195 F
(IP address found in the IP pack)33.336 216 Q
(et, identi\214es both ends of the message transmission.)-.13 E .424
(UDP pro)33.336 237 R .424(vides checksumming for error detection, b)
-.195 F .424(ut man)-.26 F 3.674(yi)-.195 G .425
(mplementations ignore it, so)-3.674 F 2.662
(it should not be assumed that UDP detects errors.)33.336 252 R 2.662
(UDP does not pro)9.162 F 2.662(vide an)-.195 F 5.912(yo)-.195 G(ther)
-5.912 E("v)33.336 267 Q(alue-added" services abo)-.325 E .39 -.195
(ve I)-.195 H -1.443(P.).195 G 0 0 127 127 -249 249 203.836 537 PBEGIN
%%BeginDocument: udppkt.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: udppkt.eps
%%Creator: fig2dev Version 3.2 Patchlevel 1
%%CreationDate: Fri Feb 26 21:12:54 1999
%%For: hak@astor.cooper.edu (hak)
%%Orientation: Portrait
%%BoundingBox: 0 0 127 249
%%Pages: 0
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-202.0 289.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n -1000 5812 m -1000 -1000 l 6478 -1000 l 6478 5812 l cp clip
 0.06000 0.06000 sc
% Polyline
7.500 slw
n 3600 1200 m 5400 1200 l 5400 1800 l 3600 1800 l cp gs col0 s gr 
% Polyline
n 3600 1800 m 5400 1800 l 5400 2400 l 3600 2400 l cp gs col0 s gr 
% Polyline
n 3600 2400 m 5400 2400 l 5400 2700 l 3600 2700 l cp gs col0 s gr 
% Polyline
n 3600 2700 m 5400 2700 l 5400 3000 l 3600 3000 l cp gs col0 s gr 
% Polyline
n 3600 3000 m 5400 3000 l 5400 4800 l 3600 4800 l cp gs col0 s gr 
% Polyline
n 3675 3075 m 5325 3075 l 5325 4725 l 3675 4725 l cp gs col0 s gr 
% Polyline
n 3675 3075 m 5325 3075 l 5325 3375 l 3675 3375 l cp gs col0 s gr 
% Polyline
n 3675 3375 m 5325 3375 l 5325 3675 l 3675 3675 l cp gs col0 s gr 
% Polyline
n 3675 3675 m 5325 3675 l 5325 4050 l 3675 4050 l cp gs col0 s gr 
/Times-Roman ff 210.00 scf sf
4425 1425 m
gs 1 -1 sc (Destination) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4425 1680 m
gs 1 -1 sc (IP Address) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2025 m
gs 1 -1 sc (Source) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2280 m
gs 1 -1 sc (IP Address) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2625 m
gs 1 -1 sc (Payload protocol) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2925 m
gs 1 -1 sc (Other headers) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 3300 m
gs 1 -1 sc (Dest. Port #) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 3675 m
gs 1 -1 sc (Src Port #) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 3975 m
gs 1 -1 sc (UDP Checksum) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 4500 m
gs 1 -1 sc (PAYLOAD) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4425 825 m
gs 1 -1 sc (A UDP Message) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4425 1080 m
gs 1 -1 sc (carried within IP packet) dup sw pop 2 div neg 0 rm  col0 sh gr
$F2psEnd
rs
%%EndDocument
end PEND 1.734(When an IP message arri)33.336 564 R -.195(ve)-.325 G
4.984(sa).195 G 4.984(tah)-4.984 G 1.734
(ost, the protocol \214eld is check)-4.984 F 4.985(ed. A)-.13 F 1.735
(UDP message)4.985 F .261
(appears within the payload \214eld of an IP pack)33.336 579 R .261
(et, with a protocol of UDP)-.13 F 6.76(.T)-1.443 G .26(he IP payload)
-6.76 F 3.131(is e)33.336 594 R 3.131(xtracted from the IP pack)-.195 F
3.131(et and handed up to the UDP module which, in turn,)-.13 F -.195
(ex)33.336 609 S .491
(amines the destination port number and \214nds a process that is w).195
F .491(aiting for messages on)-.13 F .328(that port number)33.336 624 R
6.828(.T)-.715 G .329(he payload portion of the UDP message is e)-6.828
F .329(xtracted and becomes the)-.195 F(message read by the user)33.336
639 Q(-le)-.26 E -.195(ve)-.325 G 3.25(lp).195 G(rogram.)-3.25 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 4)73.998 E(\2512013 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Bold@0 SF(TCP and r)191.799 120 Q(eliable transport)-.234
E/F2 13/Times-Roman@0 SF(The)33.336 156 Q F1 -.962(Tr)6.206 G 2.956
(ansmission Contr).962 F 2.956(ol Pr)-.234 F 2.956(otocol \(TCP\))-.234
F F2 2.956(utilizes IP to transport its payload, and)6.206 F(pro)33.336
171 Q(vides a service akin to a pair of UNIX pipes between hostA:portA \
and hostB:portB.)-.195 E 4.474<8354>33.336 186 S 1.225
(CP guarantees that data will ne)-4.474 F -.195(ve)-.325 G 4.475(rb).195
G 4.475(el)-4.475 G 1.225(ost \(without noti\214cation\).)-4.475 F 1.225
(Since it pro)7.725 F 1.225(vides a)-.195 F .311(stream service, it is \
also vital that it guarantee that data will not be deli)33.336 201 R
-.195(ve)-.325 G .31(red out of order).195 F(.)-.715 E 2.003(TCP is a c\
onnection-oriented service which utilizes 16 bit port numbers, just as \
UDP)33.336 222 R 3.283(does, to identify indi)33.336 237 R 3.283
(vidual "mailbox)-.325 F 3.283(es" on hosts.)-.195 F 3.282
(The UDP and TCP port number)9.782 F(spaces, ho)33.336 252 Q(we)-.325 E
-.195(ve)-.325 G 1.04 -.52(r, a).195 H(re independent.).52 E 4.303<8342>
33.336 267 S 1.053(efore data can be sent o)-4.303 F -.195(ve)-.195 G
4.303(rT).195 G(CP)-4.303 E 4.303(,ac)-1.443 G 1.053
(onnection has to be made between hostA:portA,)-4.303 F .337(which requ\
ests the connection, and hostB:portB, which is ready to accept the conn\
ection.)33.336 282 R .676(Either side can shut do)33.336 297 R .676
(wn the connection in either the read, write or both directions, just)
-.325 F .589(as is the case with a UNIX pipe, resulting in an "end-of-\
\214le" or "brok)33.336 312 R .588(en-pipe" indication)-.13 F
(on the remote end, as appropriate.)33.336 327 Q 4.792<8355>33.336 342 S
(nlik)-4.792 E 4.792(et)-.13 G 1.542(he message-oriented service pro)
-4.792 F 1.542(vided by UDP)-.195 F 4.792(,T)-1.443 G 1.542
(CP is a byte stream service.)-4.792 F
(There is no concept of a distinguishable "message", ag)33.336 357 Q
(ain, just lik)-.065 E 3.25(eaU)-.13 G(NIX pipe.)-3.25 E 5.078<8354>
33.336 372 S 1.828(CP pro)-5.078 F 1.828(vides \215o)-.195 F 5.078(wc)
-.325 G 1.828
(ontrol which limits the total amount of data that can be queued)-5.078
F(ag)33.336 387 Q .704(ainst a recei)-.065 F -.195(ve)-.325 G 1.744 -.52
(r, j).195 H .704(ust as is the case with a UNIX pipe.).52 F .705
(This pre)7.204 F -.195(ve)-.325 G .705(nts a f).195 F .705
(ast writer from)-.13 F -.195(ove)33.336 402 S(rrunning a slo).195 E
3.25(wr)-.325 G(eader)-3.25 E(.)-.715 E 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 5)73.998 E(\2512013 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E 0 0 127 127 -321 321 203.836 441 PBEGIN
%%BeginDocument: tcppkt.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: tcppkt.eps
%%Creator: fig2dev Version 3.2 Patchlevel 1
%%CreationDate: Fri Feb 26 21:15:51 1999
%%For: hak@astor.cooper.edu (hak)
%%Orientation: Portrait
%%BoundingBox: 0 0 127 321
%%Pages: 0
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-202.0 361.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n -1000 7012 m -1000 -1000 l 6478 -1000 l 6478 7012 l cp clip
 0.06000 0.06000 sc
% Polyline
7.500 slw
n 3600 1200 m 5400 1200 l 5400 1800 l 3600 1800 l cp gs col0 s gr 
% Polyline
n 3600 1800 m 5400 1800 l 5400 2400 l 3600 2400 l cp gs col0 s gr 
% Polyline
n 3600 2400 m 5400 2400 l 5400 2700 l 3600 2700 l cp gs col0 s gr 
% Polyline
n 3600 2700 m 5400 2700 l 5400 3000 l 3600 3000 l cp gs col0 s gr 
% Polyline
n 3675 3075 m 5325 3075 l 5325 3375 l 3675 3375 l cp gs col0 s gr 
% Polyline
n 3675 3375 m 5325 3375 l 5325 3675 l 3675 3675 l cp gs col0 s gr 
% Polyline
n 3600 3000 m 5400 3000 l 5400 6000 l 3600 6000 l cp gs col0 s gr 
% Polyline
n 3675 3675 m 5325 3675 l 5325 4200 l 3675 4200 l cp gs col0 s gr 
% Polyline
n 3675 4200 m 5325 4200 l 5325 4725 l 3675 4725 l cp gs col0 s gr 
% Polyline
n 3675 4725 m 5325 4725 l 5325 5025 l 3675 5025 l cp gs col0 s gr 
% Polyline
n 3675 5025 m 5325 5025 l 5325 5325 l 3675 5325 l cp gs col0 s gr 
% Polyline
n 3675 5325 m 5325 5325 l 5325 5850 l 3675 5850 l cp gs col0 s gr 
/Times-Roman ff 210.00 scf sf
4425 1425 m
gs 1 -1 sc (Destination) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4425 1680 m
gs 1 -1 sc (IP Address) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2025 m
gs 1 -1 sc (Source) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2280 m
gs 1 -1 sc (IP Address) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2625 m
gs 1 -1 sc (Payload protocol) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 2925 m
gs 1 -1 sc (Other headers) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 3300 m
gs 1 -1 sc (Dest. Port #) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 3675 m
gs 1 -1 sc (Src Port #) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4425 825 m
gs 1 -1 sc (A TCP Segment) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4425 1080 m
gs 1 -1 sc (carried within IP packet) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 4050 m
gs 1 -1 sc (Seq) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 4575 m
gs 1 -1 sc (Ack) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 4950 m
gs 1 -1 sc (Flags) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 5250 m
gs 1 -1 sc (Win) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman ff 210.00 scf sf
4500 5550 m
gs 1 -1 sc (PAYLOAD) dup sw pop 2 div neg 0 rm  col0 sh gr
$F2psEnd
rs
%%EndDocument
end PEND/F1 13/Times-Roman@0 SF 5.404<8354>33.336 468 S 2.154(CP pro)
-5.404 F 2.153(vides reliability by b)-.195 F(uf)-.26 E 2.153
(fering written data locally until an ackno)-.325 F(wledgement)-.325 E
2.149(message arri)33.336 483 R -.195(ve)-.325 G 5.399(sf).195 G 2.149
(rom the remote end.)-5.399 F 2.149(TCP b)8.649 F 2.149
(undles pending data into a)-.26 F/F2 13/Times-Bold@0 SF 2.149
(tcp segment)5.399 F F1 .487(which is carried within an IP pack)33.336
498 R 3.737(et. After)-.13 F .486
(sending data, TCP sets a timer which is reset)3.737 F 1.976
(when the data are ackno)33.336 513 R 5.227(wledged. If)-.325 F 1.977
(the timer goes of)5.227 F 1.977(f, the data are presumed lost in)-.325
F(transit and are re-sent.)33.336 528 Q 4.401<8349>33.336 543 S 4.401
(ne)-4.401 G 1.151(ach message, the SEQ and A)-4.401 F 1.15
(CK \214elds are modulo-2^32 numbers which pro)-.52 F 1.15(vide a)-.195
F -.13(wa)33.336 558 S 4.014(yo).13 G 4.014(fi)-4.014 G .764(dentifying\
 each byte in each of the directional streams, while WIN indicates the)
-4.014 F 1.588(maximum amount of additional data which the host is will\
ing to accept on the recei)33.336 573 R -.195(ve)-.325 G 5.138(side. If)
33.336 588 R 1.889(the stream carries more than 2^32 bytes in its lifet\
ime, the sequence numbers)5.138 F(simply roll o)33.336 603 Q -.195(ve)
-.195 G -.715(r.).195 G 5.187<8354>33.336 618 S 1.937
(he Sequence Number corresponding to the \214rst byte sent o)-5.187 F
-.195(ve)-.195 G 5.187(rt).195 G 1.937(he connection after)-5.187 F
4.662(connection establishment is kno)33.336 633 R 4.662
(wn as the Initial Sequence Number)-.325 F 11.163(.I)-.715 G 7.913(ti)
-11.163 G 7.913(sc)-7.913 G(hosen)-7.913 E .14
(randomly for reasons of performance and security)33.336 648 R 6.64(.T)
-.845 G .139(he sequence numbers in the transmit)-6.64 F(and recei)
33.336 663 Q .39 -.195(ve d)-.325 H
(irection are completely independent of each other).195 E(.)-.715 E
4.372<8357>33.336 678 S 1.123(hen the last byte of data has been sent o)
-4.372 F -.195(ve)-.195 G 4.373(rt).195 G 1.123
(he connection in a particular direction,)-4.373 F 1.034(the TCP protoc\
ol assigns a sequence number to represent the end-of-data mark.)33.336
693 R 1.034(This is)7.534 F(kno)33.336 708 Q 1.03(wn as a)-.325 F F2
(FIN)4.28 E F1 7.531(.T)C 1.031(he f)-7.531 F 1.031
(act that FIN has a sequence number means that not only are the)-.13 F
1.369(data themselv)33.336 723 R 1.369(es reliably retransmitted, b)
-.195 F 1.368(ut also the end-of-data mark, so that when that)-.26 F
.686(FIN has been ackno)33.336 738 R .686
(wledged, the sender has assurance that all of the data sent ha)-.325 F
1.077 -.195(ve b)-.26 H(een).195 E 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 6)73.998 E(\2512013 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Roman@0 SF(recei)33.336 120 Q -.195(ve)-.325 G
(d, and that the recei).195 E -.195(ve)-.325 G 3.25(ra).195 G(lso kno)
-3.25 E(ws that no more data are coming.)-.325 E 5.443<8346>33.336 135 S
2.193(urther details of the functioning of the TCP protocol are be)
-5.443 F 2.192(yond the scope of this)-.195 F(course.)33.336 150 Q/F2 13
/Times-Bold@0 SF(The r)178.091 180 Q(ole of the operating system)-.234 E
F1 1.91(On a multitasking operating system, the k)33.336 216 R 1.91
(ernel is responsible for running the protocol)-.13 F 2.35
(code necessary to implement IP)33.336 231 R 5.599(,T)-1.443 G 2.349
(CP and UDP \(at the least\), and pro)-5.599 F 2.349(vides a f)-.195 F
(acility)-.13 E .724(whereby indi)33.336 246 R .724
(vidual processes can utilize netw)-.325 F .724
(ork services and associate themselv)-.13 F .725(es with)-.195 F
(particular ports.)33.336 261 Q(Se)33.336 282 Q -.195(ve)-.325 G 1.999
(ral standard APIs ha).195 F 2.389 -.195(ve ex)-.26 H 1.998
(isted for accessing netw).195 F 1.998(ork services.)-.13 F 1.998
(The most popular)8.498 F .664(one has been the "sock)33.336 297 R .665
(ets" model introduced with the 4BSD \215a)-.13 F -.26(vo)-.26 G 3.915
(ro).26 G 3.915(fU)-3.915 G .665(NIX in the early)-3.915 F 7.902
(1980s. Man)33.336 312 R 7.902(yn)-.195 G 4.652
(on-UNIX operating systems use a v)-7.902 F 4.652
(ariant of this model, e.g. the)-.325 F("winsock" API under the MS W)
33.336 327 Q(indo)-.52 E(ws product f)-.325 E(amily)-.13 E(.)-.845 E
1.575(The \214rst step in sending or recei)33.336 348 R 1.575
(ving data across the netw)-.325 F 1.576(ork is to obtain a)-.13 F F2
(sock)4.826 E(et)-.13 E F1 8.076(.A)C(sock)33.336 363 Q
(et is just a \214le descriptor)-.13 E 3.25(,c)-.52 G(reated by the)
-3.25 E/F3 13/Courier@0 SF(socket)3.25 E F1(system call.)3.25 E/F4 12
/Courier@0 SF(#include <sys/types.h>)33.336 378 Q
(#include <sys/socket.h>)33.336 393 Q
(int socket\(domain,type,protocol\))33.336 423 Q/F5 13/Times-Italic@0 SF
(domain)33.336 444 Q F1 1.249(speci\214es an address f)4.499 F 1.249
(amily to be used for this sock)-.13 F 4.499(et. F)-.13 F 1.249
(or our applications, we)-.195 F 1.076(will use)33.336 459 R F3(AF_INET)
4.326 E F1 4.326(,w)C 1.076(hich speci\214es TCP/IP)-4.326 F 4.326(,u)
-1.443 G 1.076(sing IP v)-4.326 F 1.076(ersion 4 addressing.)-.195 F
(sock)7.576 E 1.076(ets is a)-.13 F .768
(generic API which can support a wide range of protocols and address f)
33.336 474 R 4.018(amilies. Another)-.13 F 1.846(common address f)33.336
489 R 1.846(amily is AF_UNIX, or)-.13 F F2 1.846(UNIX-Domain sock)5.096
F(ets)-.13 E F1 5.096(,i)C 5.096(nw)-5.096 G 1.846(hich the sock)-5.096
F(et)-.13 E .316
(addresses appear to be non-persistent names in the \214lesystem.)33.336
504 R .315(UNIX-domain sock)6.815 F .315(ets are)-.13 F 4.479
(restricted to intra-host communications, ho)33.336 519 R(we)-.325 E
-.195(ve)-.325 G 5.52 -.52(r, a).195 H 4.48(nd will not be co).52 F
-.195(ve)-.195 G 4.48(red further).195 F(.)-.715 E F3(AF_INET6)33.336
534 Q F1(sock)4.471 E 1.22(ets use IP v)-.13 F 1.22
(ersion 6 addressing, which is an e)-.195 F 1.22(xtension of IP v)-.195
F 1.22(ersion 4.)-.195 F
(Most applications in the internet today are still based on v)33.336 549
Q(ersion 4 addressing.)-.195 E F5(type)33.336 570 Q F1 .726
(speci\214es the type of protocol desired.)3.976 F .726(In normal sock)
7.226 F .726(ets usage,)-.13 F F5(pr)3.976 E(otocol)-.585 E F1 .727
(is left as 0)3.977 F 1.961
(and the operating system chooses the protocol based on)33.336 585 R F5
(domain)5.211 E F1(and)5.211 E F5(type)5.211 E F1 8.461(.W)C 1.961
(ithin the)-8.981 F(AF_INET domain, only 2 types are supported:)33.336
600 Q F3(SOCK_DGRAM)69.336 621 Q F1(implies the use of UDP)3.25 E(.)
-1.443 E F3(SOCK_STREAM)69.336 642 Q F1(implies the use of TCP)3.25 E(.)
-1.443 E F3(socket)33.336 663 Q F1
(returns the \214le descriptor of the ne)3.25 E 3.25(ws)-.325 G(ock)
-3.25 E(et, or -1 on error)-.13 E(.)-.715 E 0 Cg EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 7)73.998 E(\2512013 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Roman@0 SF(Under the sock)33.336 120 Q
(ets API, an address is speci\214ed with a)-.13 E/F2 13/Courier@0 SF
(struct sockaddr)3.25 E F1(:)A/F3 10/Courier@0 SF(struct sockaddr {)
33.336 132 Q(u_short sa_family;)81.336 144 Q(/* address family */)84 E
18(char sa_data[14];)81.336 156 R(/* bare minimum address buffer */)72 E
(};)33.336 168 Q F1 4.061(In practice, a struct sockaddr is ne)33.336
189 R -.195(ve)-.325 G 7.311(ru).195 G 7.311(sed. Rather)-7.311 F 7.311
(,t)-.52 G 4.061(he address structure for the)-7.311 F 1.501
(particular f)33.336 204 R 1.501(amily \(e.g.)-.13 F F2 1.5
(struct sockaddr_in\))12.55 F F1 1.5(is used.)4.75 F 1.5
(Since each such structure)8 F .486(has the address f)33.336 219 R .487
(amily as the \214rst 2 bytes, this w)-.13 F .487(orks and the k)-.13 F
.487(ernel is able to decode the)-.13 F(address further)33.336 234 Q(.)
-.715 E 1.66(Under TCP/IP)33.336 255 R 4.91(,a)-1.443 G 4.91(na)-4.91 G
1.66(ddress consists of a)-4.91 F/F4 13/Times-Bold@0 SF(netw)4.91 E 1.66
(ork addr)-.13 F(ess)-.234 E F1 4.909(,w)C 1.659
(hich identi\214es a particular)-4.909 F 1.776(host, and a)33.336 270 R
F4 1.776(port number)5.026 F F1 1.776(which resolv)5.026 F 1.776
(es indi)-.195 F 1.776(vidual sock)-.325 F 1.777(ets on the same host.)
-.13 F 1.777(This is)8.277 F(embodied in)33.336 285 Q F2
(struct sockaddr_in)3.25 E F1(:)A F3(#include <netinet/in.h>)33.336 297
Q(/* Defines sockaddr_in */)92.4 E(#include <arpa/inet.h>)33.336 309 Q
(/* Historical, include it! */)98.4 E(struct in_addr {)33.336 333 Q
(unsigned long)90.936 345 Q 150(s_addr; /*)12 F(Network byte order */)6
E(};)33.336 357 Q(struct sockaddr_in {)33.336 381 Q(short sin_family;)
90.936 393 Q(/* Always AF_INET */)70.8 E(unsigned short sin_port;)90.936
405 Q(/* Network byte order */)28.8 E(struct in_addr sin_addr;)90.936
417 Q(/* A struct, historical! */)28.8 E(char sin_zero[8];)90.936 429 Q
(/* Useless padding */)70.8 E(};)33.336 441 Q F1 5.097
(Note the seemingly pointless use of a struct to hold the netw)33.336
462 R 5.097(ork address.)-.13 F(See)11.597 E 1.158
(<netinet/in.h> for the historical reasons behind this.)33.336 477 R
1.158(Also note that s_addr and sin_port)7.658 F .126(are in netw)33.336
492 R .126(ork byte order \(big endian\), not nati)-.13 F .515 -.195
(ve \()-.325 H .125(host\) byte order!).195 F .125(The sock)6.625 F .125
(ets interf)-.13 F(ace)-.13 E 1.446
(is generic, and although we, as trained students of TCP/IP)33.336 507 R
4.696(,k)-1.443 G(no)-4.696 E 4.696(wt)-.325 G 1.446
(hat IP addresses and)-4.696 F .61
(port numbers can be interpreted as inte)33.336 522 R .61
(gers, from the standpoint of the sock)-.195 F .61(ets API, the)-.13 F
(y)-.195 E .524(are "opaque data" which must be passed through to the a\
ppropriate protocol dri)33.336 537 R -.195(ve)-.325 G 3.774(ri).195 G
3.774(nt)-3.774 G(he)-3.774 E -.13(ke)33.336 552 S
(rnel without interpretation or modi\214cation.).13 E .068
(Thus to read or write these netw)33.336 573 R .067
(ork byte order \214elds in a portable f)-.13 F .067
(ashion requires the use)-.13 F 1.739(of the byteorder macros)33.336 588
R F2 1.74(htons, htonl, ntohs)4.99 F F1(and)4.99 E F2(ntohl)4.99 E F1
1.74(which are either no-)4.99 F 1.181(ops, or byte sw)33.336 603 R
1.181(appers, depending on the nati)-.13 F 1.57 -.195(ve b)-.325 H 1.18
(yte order of the machine on which the).195 F(program is running.)33.336
618 Q .348(All sock)33.336 639 R .348(ets must be bound to a source add\
ress before data are transmitted from them.)-.13 F -1.04(To)6.849 G
-.195(ex)33.336 654 S(plicitly bind a speci\214c port number).195 E 3.25
(,u)-.52 G(se the)-3.25 E F2(bind)3.25 E F1(system call:)3.25 E F3
(int bind\(int s,struct sockaddr *name,int namelen\))33.336 666 Q F1
3.25(0i)33.336 687 S 3.25(sr)-3.25 G(eturned on success, -1 on error)
-3.25 E 6.5(.P)-.715 G(ossible errors include:)-6.5 E F2(EACCES)69.336
708 Q F1 3.954(:a)C .704(ttempt to access bind a pri)-3.954 F(vile)-.325
E .704(ged address and caller is not root \(under)-.195 F(UNIX TCP/IP)
69.336 723 Q 3.25(,p)-1.443 G(ri)-3.25 E(vile)-.325 E
(ged addresses are port numbers <1024\).)-.195 E F2(EADDRINUSE)69.336
744 Q F1 8.861(:T)C 5.611
(he requested address is already bound to another sock)-8.861 F(et)-.13
E 0 Cg EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 8)73.998 E(\2512013 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Roman@0 SF(some)69.336 120 Q(where on the machine.)-.325 E
.21(The use of)33.336 141 R/F2 13/Courier@0 SF(bind)3.46 E F1 .21
(is often skipped because the sock)3.46 F .21
(ets API speci\214es an automatic binding)-.13 F .825(to the ne)33.336
156 R .825(xt a)-.195 F -.325(va)-.26 G .826
(ilable port number under certain operations \(connect, send\).).325 F
.826(Specifying a)7.326 F/F3 13/Times-Italic@0 SF(sin_port)33.336 171 Q
F1(of 0 and)3.25 E F3(s_addr)3.25 E F1(of IN)3.25 E
(ADDR_ANY when calling)-.455 E F2(bind)3.25 E F1(also has this ef)3.25 E
(fect.)-.325 E .391(Note that)33.336 192 R F2(bind)3.641 E F1(tak)3.641
E .391(es a)-.13 F F2 .391(struct sockaddr *)3.641 F F1 3.641(,w)C .391
(hich is generic.)-3.641 F(Ho)6.891 E(we)-.325 E -.195(ve)-.325 G 1.431
-.52(r, i).195 H 3.641(ns).52 G(ock)-3.641 E(ets)-.13 E 2.109
(programming, one w)33.336 207 R 2.109(ould typically be w)-.13 F 2.11
(orking with a speci\214c structure, e.g.)-.13 F F2(struct)5.36 E
(sockaddr_in)33.336 222 Q F1 6.5(.T)C
(herefore a type cast is needed to a)-6.5 E -.26(vo)-.26 G
(id compiler w).26 E(arnings.)-.13 E 1.953(At this point, semantics di)
33.336 243 R -.195(ve)-.325 G -.234(rg).195 G 5.203(eb).234 G 1.953
(etween SOCK_DGRAM and SOCK_STREAM.)-5.203 F -.195(Fo)8.452 G(r).195 E
.793(SOCK_STREAM in AF_INET \(TCP\), a connection must be established b\
efore data can)33.336 258 R 1.272(be transferred.)33.336 273 R 1.271
(SOCK_DGRAM \(UDP\) is a stateless, connectionless protocol and does)
7.772 F(not require connection before data transfer)33.336 288 Q(.)-.715
E 0 Cg EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 9)73.998 E(\2512013 Jef)144.405 E 2.25(fH)-.225 G(akner)-2.25
E/F1 13/Times-Roman@0 SF .751(The state diagram belo)33.336 120 R 4.001
(wi)-.325 G 4.001(sd)-4.001 G(eri)-4.001 E -.195(ve)-.325 G 4.001(df)
.195 G .751(rom the TCP protocol, with e)-4.001 F .751
(xtra information along)-.195 F 1.291(the edges to describe actions tak)
33.336 135 R 1.29(en by either the local or the remote process.)-.13 F
1.29(The TCP)7.79 F(state of all sock)33.336 150 Q
(ets on the system can be queried with the)-.13 E/F2 13/Courier@0 SF
(netstat)3.25 E F1(command.)3.25 E 0 0 468 592 -420.568 532 33.336
606.568 PBEGIN
%%BeginDocument: tcpstate.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: tcpstate.fig
%%Creator: fig2dev Version 3.2 Patchlevel 4
%%CreationDate: Tue Mar 20 20:37:45 2012
%%For: hak@lex ()
%%BoundingBox: 0 0 592 532
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
newpath 0 532 moveto 0 0 lineto 592 0 lineto 592 532 lineto closepath clip newpath
-107.5 558.4 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
 /DrawEllipse {
	/endangle exch def
	/startangle exch def
	/yrad exch def
	/xrad exch def
	/y exch def
	/x exch def
	/savematrix mtrx currentmatrix def
	x y tr xrad yrad sc 0 0 1 startangle endangle arc
	closepath
	savematrix setmatrix
	} def

/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
10 setmiterlimit
0 slj 0 slc
 0.06000 0.06000 sc
%
% Fig objects follow
%
% 
% here starts figure with depth 50
% Polyline
7.500 slw
 [60] 0 sd
gs  clippath
7085 1526 m 7050 1575 l 7172 1664 l 7093 1570 l 7207 1616 l cp
eoclip
n 8400 2520 m
 7080 1560 l gs col0 s gr gr
 [] 0 sd
% arrowhead
n 7207 1616 m 7093 1570 l 7172 1664 l  col0 s
% here ends figure;
% 
% here starts figure with depth 0
% Ellipse
7.500 slw
n 2400 2400 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 4800 1200 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 6600 1200 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 5715 3375 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 9000 2400 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 2430 4785 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 9000 4800 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 9000 7200 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 2430 7200 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 5685 8700 600 600 0 360 DrawEllipse gs col-1 s gr

% Ellipse
n 5685 6000 600 600 0 360 DrawEllipse gs col-1 s gr

% Polyline
gs  clippath
2898 2004 m 2924 2058 l 3061 1994 l 2940 2018 l 3035 1939 l cp
eoclip
n 4200 1425 m
 2925 2025 l gs col-1 s gr gr

% arrowhead
n 3035 1939 m 2940 2018 l 3061 1994 l  col-1 s
% Polyline
gs  clippath
6015 1230 m 6015 1170 l 5863 1170 l 5983 1200 l 5863 1230 l cp
eoclip
n 5400 1200 m
 6000 1200 l gs col-1 s gr gr

% arrowhead
n 5863 1230 m 5983 1200 l 5863 1170 l  col-1 s
% Polyline
gs  clippath
8395 2208 m 8429 2158 l 8304 2073 l 8386 2166 l 8270 2122 l cp
eoclip
n 7200 1350 m
 8400 2175 l gs col-1 s gr gr

% arrowhead
n 8270 2122 m 8386 2166 l 8304 2073 l  col-1 s
% Polyline
gs  clippath
5105 3258 m 5123 3200 l 4978 3155 l 5084 3220 l 4960 3213 l cp
eoclip
n 2925 2550 m
 5100 3225 l gs col-1 s gr gr

% arrowhead
n 4960 3213 m 5084 3220 l 4978 3155 l  col-1 s
% Polyline
gs  clippath
6276 3126 m 6294 3183 l 6439 3136 l 6316 3145 l 6421 3079 l cp
eoclip
n 8400 2475 m
 6300 3150 l gs col-1 s gr gr

% arrowhead
n 6421 3079 m 6316 3145 l 6439 3136 l  col-1 s
% Polyline
gs  clippath
2975 4477 m 2996 4533 l 3137 4479 l 3015 4494 l 3116 4423 l cp
eoclip
n 5175 3675 m
 3000 4500 l gs col-1 s gr gr

% arrowhead
n 3116 4423 m 3015 4494 l 3137 4479 l  col-1 s
% Polyline
gs  clippath
8477 4533 m 8500 4477 l 8359 4421 l 8460 4494 l 8337 4477 l cp
eoclip
n 6225 3600 m
 8475 4500 l gs col-1 s gr gr

% arrowhead
n 8337 4477 m 8460 4494 l 8359 4421 l  col-1 s
% Polyline
gs  clippath
8970 6615 m 9030 6615 l 9030 6463 l 9000 6583 l 8970 6463 l cp
eoclip
n 9000 5400 m
 9000 6600 l gs col-1 s gr gr

% arrowhead
n 8970 6463 m 9000 6583 l 9030 6463 l  col-1 s
% Polyline
gs  clippath
5102 6033 m 5125 5978 l 4985 5920 l 5085 5994 l 4962 5975 l cp
eoclip
n 2925 5100 m
 5100 6000 l gs col-1 s gr gr

% arrowhead
n 4962 5975 m 5085 5994 l 4985 5920 l  col-1 s
% Polyline
gs  clippath
2370 6615 m 2430 6615 l 2430 6463 l 2400 6583 l 2370 6463 l cp
eoclip
n 2400 5400 m
 2400 6600 l gs col-1 s gr gr

% arrowhead
n 2370 6463 m 2400 6583 l 2430 6463 l  col-1 s
% Polyline
gs  clippath
5670 8115 m 5730 8115 l 5730 7963 l 5700 8083 l 5670 7963 l cp
eoclip
n 5700 6600 m
 5700 8100 l gs col-1 s gr gr

% arrowhead
n 5670 7963 m 5700 8083 l 5730 7963 l  col-1 s
% Polyline
gs  clippath
6200 8452 m 6221 8508 l 6362 8453 l 6240 8469 l 6341 8397 l cp
eoclip
n 8550 7575 m
 6225 8475 l gs col-1 s gr gr

% arrowhead
n 6341 8397 m 6240 8469 l 6362 8453 l  col-1 s
% Polyline
gs  clippath
5101 8583 m 5125 8528 l 4986 8467 l 5085 8543 l 4962 8522 l cp
eoclip
n 2850 7575 m
 5100 8550 l gs col-1 s gr gr

% arrowhead
n 4962 8522 m 5085 8543 l 4986 8467 l  col-1 s
/Times-Roman ff 200.00 scf sf
2400 2475 m
gs 1 -1 sc (SYN_SENT) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
6600 1275 m
gs 1 -1 sc (LISTEN) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
3525 1575 m
gs 1 -1 sc (LOCAL:Connect) dup sw pop neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
5700 600 m
gs 1 -1 sc (LOCAL:) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
3600 2025 m
gs 1 -1 sc (\(LOCAL:Send SYN\)) col-1 sh gr
/Times-Roman ff 200.00 scf sf
5775 3450 m
gs 1 -1 sc (ESTABLISHED) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
9000 2475 m
gs 1 -1 sc (SYN_RCVD) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
8250 1575 m
gs 1 -1 sc (REMOTE:SYN) col-1 sh gr
/Times-Roman ff 200.00 scf sf
7575 2475 m
gs 1 -1 sc (LOCAL:Accept) dup sw pop neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
2400 4875 m
gs 1 -1 sc (FIN_WAIT1) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
2400 7350 m
gs 1 -1 sc (FIN_WAIT2) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
9000 4875 m
gs 1 -1 sc (CLOSE_WAIT) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
5700 6150 m
gs 1 -1 sc (CLOSING) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
9000 7350 m
gs 1 -1 sc (LAST_ACK) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
5700 8850 m
gs 1 -1 sc (TIME_WAIT) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
4800 1200 m
gs 1 -1 sc (IDLE) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
7425 3825 m
gs 1 -1 sc (REMOTE: FIN, LOCAL: ACK FIN) col-1 sh gr
/Times-Roman ff 200.00 scf sf
9150 6000 m
gs 1 -1 sc (LOCAL: CLOSE, send FIN) col-1 sh gr
/Times-Roman ff 200.00 scf sf
7575 8175 m
gs 1 -1 sc (REMOTE: ACKd FIN) col-1 sh gr
/Times-Roman ff 200.00 scf sf
4425 3825 m
gs 1 -1 sc (LOCAL: CLOSE, send FIN) dup sw pop neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
3600 5250 m
gs 1 -1 sc (REMOTE:: FIN, LOCAL: ACK FIN) col-1 sh gr
/Times-Roman ff 200.00 scf sf
2550 6225 m
gs 1 -1 sc (REMOTE: ACKd FIN) col-1 sh gr
/Times-Roman ff 200.00 scf sf
3600 7725 m
gs 1 -1 sc (REMOTE: FIN, LOCAL:) col-1 sh gr
/Times-Roman ff 200.00 scf sf
3600 7995 m
gs 1 -1 sc (          ACK FIN) col-1 sh gr
/Times-Roman ff 200.00 scf sf
5850 7125 m
gs 1 -1 sc (REMOTE: ACKd FIN) col-1 sh gr
/Times-Roman ff 200.00 scf sf
5700 870 m
gs 1 -1 sc (bind+listen) dup sw pop 2 div neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
7560 2040 m
gs 1 -1 sc (\(CLONED\)) dup sw pop neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
7575 2745 m
gs 1 -1 sc (send SYN+ACK) dup sw pop neg 0 rm  col-1 sh gr
/Times-Roman ff 200.00 scf sf
3525 2625 m
gs 1 -1 sc (REMOTE:SYN) col-1 sh gr
/Times-Roman ff 200.00 scf sf
3900 2850 m
gs 1 -1 sc (LOCAL:ACK ) col-1 sh gr
% here ends figure;
$F2psEnd
rs
showpage
%%EndDocument
end PEND 0 Cg EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 10)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Roman@0 SF 5.324(There are tw)33.336 120 R 8.575(os)
-.13 G 5.325(ides to opening a SOCK_STREAM\(TCP\) connection.)-8.575 F
5.325(First, the)11.825 F -1.196(PA)33.336 135 S 1.352
(SSIVE opener binds a speci\214c port number and issues a)1.196 F/F2 13
/Times-Italic@0 SF(listen)4.602 E F1 4.602(,e)C 1.352
(nabling that port to)-4.602 F(recei)33.336 150 Q .692 -.195(ve c)-.325
H .302(onnection requests.).195 F 3.552(Then A)6.802 F .303
(CTIVE opener issues a)-.52 F F2(connect)3.553 E F1 .303
(specifying a remote)3.553 F(address and port number)33.336 165 Q(.)
-.715 E/F3 12/Courier@0 SF(#include <sys/types.h>)33.336 195 Q
(#include <sys/socket.h>)33.336 210 Q 7.2(int connect\(int sockfd,)
33.336 240 R(struct sockaddr *serv_addr, int)7.2 E(addrlen \);)33.336
255 Q F1 1.051
(This causes the TCP protocol to query the remote system \()33.336 285 R
F2(sin_addr)A F1 4.301(\)t)C 4.301(os)-4.301 G 1.051(ee if an)-4.301 F
1.051(yone is)-.195 F 10.177(listening on the speci\214ed)33.336 300 R
F2(sin_port)13.428 E F1 16.678(.I)C 13.428(fn)-16.678 G(ot,)-13.428 E/F4
13/Courier@0 SF(connect)13.428 E F1 10.178(comes back with)13.428 F
6.045(ECONNREFUSED. Otherwise,)33.336 315 R 2.795
(the connection proceeds.)6.045 F F4(connect)9.295 E F1 2.795
(blocks until the)6.045 F
(connection is either established, refused or times out.)33.336 330 Q F4
(connect)33.336 351 Q F1 3.164(can be called for SOCK_DGRAM sock)6.413 F
3.164(ets as a con)-.13 F -.195(ve)-.52 G 3.164(nience function.).195 F
(It)9.664 E 1.209(causes the k)33.336 366 R 1.208
(ernel to remember the destination address, b)-.13 F 1.208
(ut does not result in an)-.26 F 4.458(ya)-.195 G(ctual)-4.458 E
(protocol action.)33.336 381 Q 2.648(On the P)33.336 402 R 2.648
(ASSIVE side, the listening process uses)-1.196 F F4(accept)5.898 E F1
2.648(to recei)5.898 F 3.038 -.195(ve a)-.325 H 2.648(nd accept the).195
F(incoming connection.)33.336 417 Q F3
(int accept\(int listener_fd,struct sockaddr *addr,int *addrlen\))33.336
432 Q F2(addrlen)33.336 453 Q F1 3.571(is a)6.821 F/F5 13/Times-Bold@0
SF -.13(va)6.821 G(lue-r).13 E(esult)-.234 E F1(parameter)6.821 E 10.071
(.I)-.715 G 6.821(tm)-10.071 G 3.571(ust be set before calling)-6.821 F
F4(accept)6.821 E F1 3.571(to the)6.821 F .439(maximum allo)33.336 468 R
-.13(wa)-.325 G .439(ble size to return in).13 F F2(addr)3.689 E F1
6.939(.W)C(hen)-6.939 E F4(accept)3.689 E F1 .439
(returns, it contains the actual)3.689 F(size used.)33.336 483 Q -.195
(Fo)6.5 G 3.25(rT).195 G(CP/IP)-3.25 E 3.25(,t)-1.443 G
(he address is \214x)-3.25 E
(ed-length, so this is a super\215uous feature.)-.195 E F4(accept)33.336
504 Q F1 1.351(blocks until a connection arri)4.601 F -.195(ve)-.325 G
(s.).195 E F4(accept)7.851 E F1 1.351(creates a)4.601 F F5 1.351
(new sock)4.601 F(et)-.13 E F1 1.35(to reference)4.601 F .116
(the incoming connection, and returns its \214le descriptor)33.336 519 R
6.616(.T)-.715 G .116(he remote address is returned in)-6.616 F F2(addr)
33.336 534 Q F1 8.848(.T)C 2.348(he original sock)-8.848 F(et,)-.13 E F2
(listener_fd)5.598 E F1 5.598(,c)C 2.348(ontinues to e)-5.598 F 2.347
(xist in the LISTEN state, where)-.195 F 4.878
(more connection requests can be accepted.)33.336 549 R 4.879
(The returned sock)11.379 F 4.879(et adv)-.13 F 4.879(ances to the)-.325
F(EST)33.336 564 Q 3.139
(ABLISHED state, where data can be transferred between the hosts.)-1.209
F 3.138(If multiple)9.639 F 2.309(connection requests arri)33.336 579 R
2.699 -.195(ve r)-.325 H(apidly).195 E 5.559(,t)-.845 G 2.309
(he cloned sock)-5.559 F 2.31(ets reside in the SYN_RCVD state)-.13 F
.76(until, one by one, the)33.336 594 R 4.01(ya)-.195 G .76(re accept')
-4.01 F 4.01(db)-.65 G 4.01(yt)-4.01 G .76(he process.)-4.01 F .76
(The operating system may impose a)7.26 F 1.105
(limit on these "backlogged" nascent connections.)33.336 609 R 1.105
(This limit can be set \(within a range\))7.605 F
(by the second parameter in the)33.336 624 Q F4(listen)3.25 E F1
(system call.)3.25 E 0 Cg EP
%%Page: 11 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 11)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E 0 0 468 579 -303.109 375 33.336 423.109 PBEGIN
%%BeginDocument: tcpest.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: tcpest.eps
%%Creator: fig2dev Version 3.2 Patchlevel 1
%%CreationDate: Fri Feb 26 21:34:20 1999
%%For: hak@astor.cooper.edu (hak)
%%Orientation: Portrait
%%BoundingBox: 0 0 579 375
%%Pages: 0
%%BeginSetup
%%EndSetup
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
-63.0 397.0 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/reencdict 12 dict def /ReEncode { reencdict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq
{ exch dup length array copy newfont 3 1 roll put }
{ exch newfont 3 1 roll put } ifelse } { pop pop } ifelse } forall
newfont /FontName newfontname put newcodesandnames aload pop
128 1 255 { newfont /Encoding get exch /.notdef put } for
newcodesandnames length 2 idiv { newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/isovec [
8#200 /grave 8#201 /acute 8#202 /circumflex 8#203 /tilde
8#204 /macron 8#205 /breve 8#206 /dotaccent 8#207 /dieresis
8#210 /ring 8#211 /cedilla 8#212 /hungarumlaut 8#213 /ogonek 8#214 /caron
8#220 /dotlessi 8#230 /oe 8#231 /OE
8#240 /space 8#241 /exclamdown 8#242 /cent 8#243 /sterling
8#244 /currency 8#245 /yen 8#246 /brokenbar 8#247 /section 8#250 /dieresis
8#251 /copyright 8#252 /ordfeminine 8#253 /guillemotleft 8#254 /logicalnot
8#255 /endash 8#256 /registered 8#257 /macron 8#260 /degree 8#261 /plusminus
8#262 /twosuperior 8#263 /threesuperior 8#264 /acute 8#265 /mu 8#266 /paragraph
8#267 /periodcentered 8#270 /cedilla 8#271 /onesuperior 8#272 /ordmasculine
8#273 /guillemotright 8#274 /onequarter 8#275 /onehalf
8#276 /threequarters 8#277 /questiondown 8#300 /Agrave 8#301 /Aacute
8#302 /Acircumflex 8#303 /Atilde 8#304 /Adieresis 8#305 /Aring
8#306 /AE 8#307 /Ccedilla 8#310 /Egrave 8#311 /Eacute
8#312 /Ecircumflex 8#313 /Edieresis 8#314 /Igrave 8#315 /Iacute
8#316 /Icircumflex 8#317 /Idieresis 8#320 /Eth 8#321 /Ntilde 8#322 /Ograve
8#323 /Oacute 8#324 /Ocircumflex 8#325 /Otilde 8#326 /Odieresis 8#327 /multiply
8#330 /Oslash 8#331 /Ugrave 8#332 /Uacute 8#333 /Ucircumflex
8#334 /Udieresis 8#335 /Yacute 8#336 /Thorn 8#337 /germandbls 8#340 /agrave
8#341 /aacute 8#342 /acircumflex 8#343 /atilde 8#344 /adieresis 8#345 /aring
8#346 /ae 8#347 /ccedilla 8#350 /egrave 8#351 /eacute
8#352 /ecircumflex 8#353 /edieresis 8#354 /igrave 8#355 /iacute
8#356 /icircumflex 8#357 /idieresis 8#360 /eth 8#361 /ntilde 8#362 /ograve
8#363 /oacute 8#364 /ocircumflex 8#365 /otilde 8#366 /odieresis 8#367 /divide
8#370 /oslash 8#371 /ugrave 8#372 /uacute 8#373 /ucircumflex
8#374 /udieresis 8#375 /yacute 8#376 /thorn 8#377 /ydieresis] def
/Times-Roman /Times-Roman-iso isovec ReEncode
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def
%%EndProlog

$F2psBegin
10 setmiterlimit
n -1000 7612 m -1000 -1000 l 11686 -1000 l 11686 7612 l cp clip
 0.06000 0.06000 sc
% Polyline
7.500 slw
n 1800 1200 m 4575 1200 l 4575 1800 l 1800 1800 l cp gs col0 s gr 
/Times-Roman-iso ff 180.00 scf sf
1875 1425 m
gs 1 -1 sc (Local Prt: -) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
1875 1650 m
gs 1 -1 sc (Rem: -) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
3225 1425 m
gs 1 -1 sc (STATE: -) col0 sh gr
% Polyline
n 5625 1200 m 8400 1200 l 8400 1800 l 5625 1800 l cp gs col0 s gr 
/Times-Roman-iso ff 180.00 scf sf
5700 1425 m
gs 1 -1 sc (Local Prt: -) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
5700 1650 m
gs 1 -1 sc (Rem: -) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
7050 1425 m
gs 1 -1 sc (STATE: -) col0 sh gr
% Polyline
n 5625 2400 m 8400 2400 l 8400 3000 l 5625 3000 l cp gs col0 s gr 
/Times-Roman-iso ff 180.00 scf sf
5700 2625 m
gs 1 -1 sc (Local Prt: 1234) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
5700 2850 m
gs 1 -1 sc (Rem: -) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
7050 2625 m
gs 1 -1 sc (STATE: LISTEN) col0 sh gr
% Polyline
n 5625 3600 m 8400 3600 l 8400 4200 l 5625 4200 l cp gs col0 s gr 
/Times-Roman-iso ff 180.00 scf sf
5700 3825 m
gs 1 -1 sc (Local Prt: 1234) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
5700 4050 m
gs 1 -1 sc (Rem: -) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
7050 3825 m
gs 1 -1 sc (STATE: LISTEN) col0 sh gr
% Polyline
n 1800 3000 m 4575 3000 l 4575 3600 l 1800 3600 l cp gs col0 s gr 
/Times-Roman-iso ff 180.00 scf sf
1875 3225 m
gs 1 -1 sc (Local Prt: 4567) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
1875 3450 m
gs 1 -1 sc (Rem: 1.2.3.4:1234) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
3225 3225 m
gs 1 -1 sc (STATE: SYN S) col0 sh gr
% Polyline
n 5625 4800 m 8400 4800 l 8400 5400 l 5625 5400 l cp gs col0 s gr 
/Times-Roman-iso ff 180.00 scf sf
5700 5025 m
gs 1 -1 sc (Local Prt: 1234) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
5700 5250 m
gs 1 -1 sc (Rem: -) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
7050 5025 m
gs 1 -1 sc (STATE: LISTEN) col0 sh gr
% Polyline
n 5625 6000 m 8400 6000 l 8400 6600 l 5625 6600 l cp gs col0 s gr 
/Times-Roman-iso ff 180.00 scf sf
5700 6225 m
gs 1 -1 sc (Local Prt: 1234) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
5700 6450 m
gs 1 -1 sc (Rem: 4.5.6.7:4567) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
7050 6225 m
gs 1 -1 sc (STATE:ESTAB) col0 sh gr
% Polyline
n 1800 6000 m 4575 6000 l 4575 6600 l 1800 6600 l cp gs col0 s gr 
/Times-Roman-iso ff 180.00 scf sf
1875 6225 m
gs 1 -1 sc (Local Prt: 4567) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
1875 6450 m
gs 1 -1 sc (Rem: 1.2.3.4:1234) col0 sh gr
/Times-Roman-iso ff 180.00 scf sf
3225 6225 m
gs 1 -1 sc (STATE: ESTAB) col0 sh gr
% Polyline
gs  clippath
5608 3742 m 5700 3825 l 5580 3795 l 5699 3859 l 5727 3806 l cp
clip
n 4575 3225 m 5700 3825 l gs col0 s gr gr

% arrowhead
n 5608 3742 m 5700 3825 l 5580 3795 l  col0 s
% Polyline
 [60] 0 sd
gs  clippath
5861 5894 m 5925 6000 l 5819 5936 l 5914 6032 l 5957 5989 l cp
clip
n 6075 4125 m 5175 5250 l 5925 6000 l gs col0 s gr gr
 [] 0 sd
% arrowhead
n 5861 5894 m 5925 6000 l 5819 5936 l  col0 s
% Polyline
gs  clippath
5505 6120 m 5625 6150 l 5505 6180 l 5640 6180 l 5640 6120 l cp
clip
n 4575 6150 m 5625 6150 l gs col0 s gr gr

% arrowhead
n 5505 6120 m 5625 6150 l 5505 6180 l  col0 s
% Polyline
gs  clippath
4695 6480 m 4575 6450 l 4695 6420 l 4560 6420 l 4560 6480 l cp
clip
n 5625 6450 m 4575 6450 l gs col0 s gr gr

% arrowhead
n 4695 6480 m 4575 6450 l 4695 6420 l  col0 s
/Times-Roman-iso ff 210.00 scf sf
7200 900 m
gs 1 -1 sc (Passive Side \(1.2.3.4\)) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
3225 900 m
gs 1 -1 sc (Active side \(4.5.6.7\)) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
5175 525 m
gs 1 -1 sc (Establishing a TCP connection) dup sw pop 2 div neg 0 rm  col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
1050 1425 m
gs 1 -1 sc (open) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
1050 1680 m
gs 1 -1 sc (socket) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8550 1425 m
gs 1 -1 sc (open) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8550 1680 m
gs 1 -1 sc (socket) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8550 2400 m
gs 1 -1 sc (bind port 1234) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8550 2655 m
gs 1 -1 sc (listen) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
1050 3150 m
gs 1 -1 sc (connect) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8625 4275 m
gs 1 -1 sc (accept) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8625 4530 m
gs 1 -1 sc (\(creates a) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8625 4785 m
gs 1 -1 sc ( new socket\)) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8625 5250 m
gs 1 -1 sc (original socket) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8625 5505 m
gs 1 -1 sc (remains in LISTEN) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8625 6225 m
gs 1 -1 sc (new socket) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
8625 6480 m
gs 1 -1 sc (is used for data transfer) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
1050 4725 m
gs 1 -1 sc (\(connect blocks\)) col0 sh gr
/Times-Roman-iso ff 210.00 scf sf
1050 5850 m
gs 1 -1 sc (\(connect returns\)) col0 sh gr
$F2psEnd
rs
%%EndDocument
end PEND/F1 13/Times-Roman@0 SF 2.033
(Determining at what address to listen is no small task.)33.336 450.109
R 2.033(Certain services are generally)8.533 F 2.665(assigned to speci\
\214c port numbers, which are controlled by internet standards bodies.)
33.336 465.109 R .714(These are the so-called "well-kno)33.336 480.109 R
.714(wn ports," such as the SMTP mail protocol on port 25,)-.325 F
(and the SSH remote login service on port 22.)33.336 495.109 Q .79
(This raises the issue of uniqueness.)33.336 516.109 R .79(In TCP)7.29 F
4.04(,ac)-1.443 G .791(onnection is identi\214ed by the pair {local)
-4.04 F .639(port, local address}/{remote port, remote address}.)33.336
531.109 R .639(This allo)7.139 F .639(ws the local port number to)-.325
F .795(be o)33.336 546.109 R -.195(ve)-.195 G .795(rloaded for serv).195
F 4.046(ers. F)-.195 F .796(or e)-.195 F .796(xample, at an)-.195 F
4.046(yt)-.195 G .796(ime there may be multiple sock)-4.046 F .796
(ets open)-.13 F 1.442(with a local port number of 23 \(TELNET\), b)
33.336 561.109 R 1.442(ut each is connected to a dif)-.26 F 1.442
(ferent remote)-.325 F(address/port.)33.336 576.109 Q 0 Cg EP
%%Page: 12 12
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 12)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Roman@0 SF(Let')33.336 120 Q 7.269(sl)-.715 G 4.019
(ook at an e)-7.269 F 4.019
(xample of binding, listening and accepting a connection on the)-.195 F
-1.196(PA)33.336 135 S(SSIVE side:)1.196 E/F2 10/Courier@0 SF
(#include <sys/types.h>)33.336 147 Q(#include <sys/socket.h>)33.336 159
Q(#include <netinet/in.h>)33.336 171 Q(#include <arpa/inet.h>)33.336 183
Q(f\(\))33.336 207 Q({)33.336 219 Q(struct sockaddr_in sin;)33.336 231 Q
(int s,s2,len;)33.336 243 Q
(if \(\(s=socket\(AF_INET,SOCK_STREAM,0\)\)<0\))90.936 255 Q({)90.936
267 Q(perror\("socket"\);)148.536 279 Q(return -1;)148.536 291 Q(})
90.936 303 Q(sin.sin_family=AF_INET;)90.936 315 Q 86.4
(sin.sin_port=htons\(25\); /*)90.936 327 R(The mail port */)6 E
(sin.sin_addr.s_addr=INADDR_ANY;)90.936 339 Q
(if \(bind\(s,\(struct sockaddr *\)&sin,sizeof sin\)<0\))90.936 351 Q({)
90.936 363 Q(perror\("bind"\);)148.536 375 Q(close\(s\);)148.536 387 Q
(return -1;)148.536 399 Q(})90.936 411 Q(if \(listen\(s,128\)<0\))90.936
423 Q({)90.936 435 Q(perror\("listen"\);)148.536 447 Q(return -1;)
206.136 459 Q(})90.936 471 Q(len=sizeof sin;)90.936 483 Q
(if \(\(s2=accept\(s,\(struct sockaddr *\)&sin,&len\)\)<0\))90.936 495 Q
({)90.936 507 Q(perror\("accept"\);)148.536 519 Q(return -1;)148.536 531
Q(})90.936 543 Q(return s2;)90.936 555 Q(})33.336 567 Q/F3 13
/Times-Bold@0 SF(Sock)203.967 588 Q(ets and r)-.13 E(ead/write)-.234 E
F1(Sock)33.336 618 Q .126(ets are a form of \214le, and through the abs\
traction layer of the virtual \214le system code)-.13 F .428
(within the k)33.336 633 R .428(ernel, man)-.13 F 3.678(yo)-.195 G 3.678
(ft)-3.678 G .428(he same system calls which w)-3.678 F .428(ork for re)
-.13 F .429(gular \214les on the disk)-.195 F 2.036(also w)33.336 648 R
2.036(ork for sock)-.13 F 5.286(ets. Under)-.13 F 2.036(the Linux k)
5.286 F 2.035(ernel, an in-core inode e)-.13 F 2.035
(xists for each open)-.195 F(sock)33.336 663 Q 3.88(et. It)-.13 F .631
(belongs to \214le system type)3.881 F/F4 13/Courier@0 SF(sockfs)3.881 E
F1 .631(\(in much the same w)3.881 F .631(ay that pipes belong)-.13 F
(to)33.336 678 Q F4(pipefs)3.25 E F1 3.25(\). The)B(inode type is)3.25 E
F4(S_IFSOCK)3.25 E F1(.)A 3.422 -1.04(We c)33.336 699 T 1.341
(an think of a TCP connection as a pair of pipes connecting the tw)1.04
F 4.591(oe)-.13 G 4.591(ndpoints. In)-4.591 F(particular)33.336 714 Q
7.464(,o)-.52 G 4.214(nce a connection has reached the TCP EST)-7.464 F
4.215(ABLISHED state, the tw)-1.209 F(o)-.13 E
(directions are independent of each other)33.336 729 Q(.)-.715 E 0 Cg EP
%%Page: 13 13
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 13)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E 0 0 468 622 -138.444 184 33.336 258.444 PBEGIN
%%BeginDocument: tcpbuffers.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: tcpbuffers.fig
%%Creator: fig2dev Version 3.2 Patchlevel 4
%%CreationDate: Fri Nov  1 01:00:58 2013
%%For: hak@lex ()
%%BoundingBox: 0 0 622 184
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
newpath 0 184 moveto 0 0 lineto 622 0 lineto 622 184 lineto closepath clip newpath
-63.0 312.2 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
10 setmiterlimit
0 slj 0 slc
 0.06000 0.06000 sc
%
% Fig objects follow
%
% 
% here starts figure with depth 50
% Polyline
7.500 slw
gs  clippath
2715 3255 m 2715 3195 l 2563 3195 l 2683 3225 l 2563 3255 l cp
eoclip
n 1650 3225 m
 2700 3225 l gs col0 s gr gr

% arrowhead
n 2563 3255 m 2683 3225 l 2563 3195 l  col0 s
% Polyline
n 2700 3000 m 4350 3000 l 4350 3525 l 2700 3525 l
 cp gs col0 s gr 
% Polyline
n 8475 3000 m 10125 3000 l 10125 3525 l 8475 3525 l
 cp gs col0 s gr 
% Polyline
gs  clippath
10815 3330 m 10815 3270 l 10663 3270 l 10783 3300 l 10663 3330 l cp
eoclip
n 10125 3300 m
 10800 3300 l gs col0 s gr gr

% arrowhead
n 10663 3330 m 10783 3300 l 10663 3270 l  col0 s
% Polyline
gs  clippath
5190 3255 m 5190 3195 l 5038 3195 l 5158 3225 l 5038 3255 l cp
eoclip
n 4350 3225 m
 5175 3225 l gs col0 s gr gr

% arrowhead
n 5038 3255 m 5158 3225 l 5038 3195 l  col0 s
% Polyline
gs  clippath
8490 3330 m 8490 3270 l 8338 3270 l 8458 3300 l 8338 3330 l cp
eoclip
n 7950 3300 m
 8475 3300 l gs col0 s gr gr

% arrowhead
n 8338 3330 m 8458 3300 l 8338 3270 l  col0 s
% Polyline
n 5625 2925 m 5775 2925 l 5775 3300 l 5625 3300 l
 cp gs col0 s gr 
% Polyline
n 5925 2925 m 6075 2925 l 6075 3300 l 5925 3300 l
 cp gs col0 s gr 
% Polyline
n 6525 2925 m 6675 2925 l 6675 3300 l 6525 3300 l
 cp gs col0 s gr 
% Polyline
n 7050 2925 m 7200 2925 l 7200 3300 l 7050 3300 l
 cp gs col0 s gr 
% Polyline
n 5625 3750 m 5775 3750 l 5775 4125 l 5625 4125 l
 cp gs col0 s gr 
% Polyline
n 6075 3750 m 6225 3750 l 6225 4125 l 6075 4125 l
 cp gs col0 s gr 
% Polyline
n 6300 3750 m 6450 3750 l 6450 4125 l 6300 4125 l
 cp gs col0 s gr 
% Polyline
n 6975 3750 m 7125 3750 l 7125 4125 l 6975 4125 l
 cp gs col0 s gr 
% Polyline
n 7200 3750 m 7350 3750 l 7350 4125 l 7200 4125 l
 cp gs col0 s gr 
% Polyline
n 8475 3675 m 10125 3675 l 10125 4200 l 8475 4200 l
 cp gs col0 s gr 
% Polyline
n 2700 3675 m 4350 3675 l 4350 4200 l 2700 4200 l
 cp gs col0 s gr 
% Polyline
gs  clippath
10110 3945 m 10110 4005 l 10262 4005 l 10142 3975 l 10262 3945 l cp
eoclip
n 10725 3975 m
 10125 3975 l gs col0 s gr gr

% arrowhead
n 10262 3945 m 10142 3975 l 10262 4005 l  col0 s
% Polyline
gs  clippath
7860 3945 m 7860 4005 l 8012 4005 l 7892 3975 l 8012 3945 l cp
eoclip
n 8475 3975 m
 7875 3975 l gs col0 s gr gr

% arrowhead
n 8012 3945 m 7892 3975 l 8012 4005 l  col0 s
% Polyline
gs  clippath
4335 3945 m 4335 4005 l 4487 4005 l 4367 3975 l 4487 3945 l cp
eoclip
n 4950 3975 m
 4350 3975 l gs col0 s gr gr

% arrowhead
n 4487 3945 m 4367 3975 l 4487 4005 l  col0 s
% Polyline
gs  clippath
1560 3945 m 1560 4005 l 1712 4005 l 1592 3975 l 1712 3945 l cp
eoclip
n 2700 3975 m
 1575 3975 l gs col0 s gr gr

% arrowhead
n 1712 3945 m 1592 3975 l 1712 4005 l  col0 s
% Polyline
2 slj
n 6075 2325 m 6135 2300 l 6192 2278 l 6243 2259 l 6288 2242 l 6327 2228 l
 6358 2216 l 6383 2206 l 6403 2198 l 6417 2192 l 6427 2186 l
 6434 2182 l 6440 2178 l 6444 2175 l 6448 2172 l 6453 2170 l
 6461 2168 l 6471 2166 l 6486 2164 l 6506 2162 l 6532 2161 l
 6564 2160 l 6604 2160 l 6650 2161 l 6704 2163 l 6762 2168 l
 6825 2175 l 6880 2184 l 6934 2193 l 6985 2204 l 7033 2215 l
 7077 2225 l 7117 2234 l 7152 2243 l 7183 2250 l 7210 2257 l
 7233 2262 l 7254 2267 l 7273 2271 l 7289 2275 l 7304 2278 l
 7319 2281 l 7333 2285 l 7348 2289 l 7363 2295 l 7380 2301 l
 7399 2309 l 7420 2319 l 7444 2332 l 7471 2347 l 7501 2366 l
 7533 2388 l 7569 2413 l 7607 2442 l 7646 2475 l 7686 2511 l
 7725 2550 l 7763 2594 l 7797 2637 l 7827 2680 l 7852 2719 l
 7872 2755 l 7889 2787 l 7901 2815 l 7910 2839 l 7916 2860 l
 7920 2878 l 7921 2894 l 7921 2907 l 7920 2919 l 7919 2931 l
 7917 2943 l 7915 2956 l 7913 2970 l 7911 2987 l 7911 3006 l
 7911 3029 l 7913 3056 l 7916 3088 l 7920 3125 l 7925 3167 l
 7931 3214 l 7937 3265 l 7944 3319 l 7950 3375 l 7955 3435 l
 7958 3492 l 7959 3544 l 7959 3590 l 7958 3630 l 7955 3664 l
 7952 3692 l 7947 3714 l 7942 3732 l 7937 3746 l 7931 3757 l
 7925 3767 l 7919 3775 l 7912 3783 l 7906 3792 l 7900 3802 l
 7895 3815 l 7889 3832 l 7884 3852 l 7880 3877 l 7876 3907 l
 7874 3943 l 7872 3983 l 7872 4028 l 7873 4076 l 7875 4125 l
 7879 4177 l 7885 4225 l 7893 4267 l 7903 4303 l 7916 4333 l
 7930 4356 l 7946 4373 l 7963 4386 l 7981 4395 l 8000 4400 l
 8019 4404 l 8038 4406 l 8056 4409 l 8073 4412 l 8089 4417 l
 8103 4424 l 8113 4436 l 8120 4451 l 8122 4472 l 8118 4498 l
 8107 4529 l 8088 4566 l 8061 4607 l 8025 4650 l 7994 4681 l
 7961 4711 l 7926 4740 l 7890 4767 l 7855 4793 l 7820 4817 l
 7787 4838 l 7756 4858 l 7727 4876 l 7699 4893 l 7673 4907 l
 7649 4921 l 7627 4933 l 7605 4945 l 7584 4955 l 7564 4965 l
 7544 4975 l 7523 4984 l 7502 4994 l 7480 5004 l 7457 5013 l
 7431 5024 l 7404 5035 l 7374 5046 l 7340 5058 l 7304 5071 l
 7264 5084 l 7221 5098 l 7174 5112 l 7124 5126 l 7071 5140 l
 7015 5153 l 6958 5165 l 6900 5175 l 6831 5184 l 6767 5189 l
 6707 5192 l 6652 5192 l 6604 5189 l 6563 5186 l 6527 5180 l
 6496 5174 l 6470 5167 l 6449 5159 l 6430 5151 l 6414 5143 l
 6400 5134 l 6387 5125 l 6375 5116 l 6363 5106 l 6349 5096 l
 6334 5086 l 6318 5075 l 6299 5063 l 6278 5051 l 6253 5039 l
 6227 5026 l 6197 5012 l 6167 4997 l 6135 4982 l 6104 4966 l
 6075 4950 l 6035 4923 l 6011 4898 l 6000 4879 l 6002 4866 l
 6012 4857 l 6030 4853 l 6051 4851 l 6075 4850 l 6099 4849 l
 6123 4847 l 6143 4841 l 6159 4831 l 6169 4814 l 6171 4791 l
 6165 4761 l 6150 4725 l 6135 4697 l 6118 4671 l 6102 4646 l
 6087 4624 l 6073 4605 l 6062 4590 l 6053 4577 l 6046 4566 l
 6041 4558 l 6036 4550 l 6031 4544 l 6026 4537 l 6020 4530 l
 6011 4521 l 6000 4510 l 5984 4497 l 5964 4480 l 5938 4460 l
 5907 4437 l 5868 4410 l 5824 4381 l 5775 4350 l 5734 4326 l
 5693 4304 l 5653 4283 l 5615 4264 l 5579 4248 l 5547 4235 l
 5517 4223 l 5490 4214 l 5465 4207 l 5443 4201 l 5423 4196 l
 5404 4193 l 5386 4190 l 5369 4187 l 5352 4185 l 5334 4182 l
 5316 4179 l 5297 4175 l 5276 4170 l 5254 4164 l 5230 4155 l
 5204 4145 l 5176 4134 l 5146 4120 l 5115 4104 l 5084 4087 l
 5053 4069 l 5025 4050 l 4996 4029 l 4973 4009 l 4956 3991 l
 4943 3976 l 4935 3964 l 4931 3955 l 4930 3948 l 4932 3944 l
 4936 3941 l 4942 3939 l 4949 3938 l 4956 3937 l 4964 3937 l
 4972 3936 l 4980 3934 l 4988 3931 l 4995 3927 l 5001 3920 l
 5007 3911 l 5012 3899 l 5016 3884 l 5019 3866 l 5022 3846 l
 5025 3825 l 5030 3792 l 5035 3763 l 5040 3739 l 5045 3721 l
 5048 3709 l 5051 3701 l 5054 3697 l 5056 3694 l 5059 3690 l
 5062 3685 l 5065 3676 l 5070 3661 l 5075 3639 l 5082 3608 l
 5091 3570 l 5100 3525 l 5107 3487 l 5114 3451 l 5120 3417 l
 5125 3388 l 5129 3362 l 5132 3341 l 5134 3323 l 5136 3307 l
 5137 3294 l 5138 3281 l 5138 3269 l 5139 3256 l 5141 3241 l
 5143 3225 l 5146 3206 l 5150 3184 l 5155 3159 l 5161 3131 l
 5168 3103 l 5175 3075 l 5187 3037 l 5197 3013 l 5205 3001 l
 5211 2999 l 5215 3004 l 5219 3013 l 5222 3021 l 5226 3028 l
 5230 3031 l 5236 3028 l 5243 3017 l 5250 3000 l 5252 2992 l
 5254 2985 l 5255 2978 l 5254 2972 l 5253 2967 l 5250 2963 l
 5246 2960 l 5241 2958 l 5235 2956 l 5228 2956 l 5221 2957 l
 5213 2958 l 5204 2959 l 5196 2961 l 5187 2963 l 5179 2964 l
 5172 2965 l 5165 2966 l 5159 2966 l 5154 2965 l 5151 2962 l
 5150 2958 l 5151 2953 l 5154 2945 l 5161 2935 l 5171 2923 l
 5185 2908 l 5203 2891 l 5224 2872 l 5250 2850 l 5279 2827 l
 5310 2803 l 5342 2779 l 5373 2756 l 5403 2734 l 5431 2714 l
 5457 2695 l 5481 2677 l 5502 2661 l 5522 2647 l 5539 2634 l
 5556 2621 l 5571 2610 l 5586 2598 l 5600 2587 l 5615 2577 l
 5630 2565 l 5647 2554 l 5665 2541 l 5685 2528 l 5709 2514 l
 5735 2498 l 5765 2480 l 5798 2461 l 5836 2441 l 5877 2419 l
 5923 2396 l 5971 2372 l 6023 2348 l
 cp gs col0 s gr 
/Times-Roman ff 200.00 scf sf
1050 3300 m
gs 1 -1 sc (write) col0 sh gr
/Times-Roman ff 200.00 scf sf
10875 3375 m
gs 1 -1 sc (read) col0 sh gr
/Times-Roman ff 200.00 scf sf
2925 3300 m
gs 1 -1 sc (sndbuf) col0 sh gr
/Times-Roman ff 200.00 scf sf
8775 3300 m
gs 1 -1 sc (rcvbuf) col0 sh gr
/Times-Roman ff 200.00 scf sf
1125 4050 m
gs 1 -1 sc (read) col0 sh gr
/Times-Roman ff 200.00 scf sf
10950 4050 m
gs 1 -1 sc (write) col0 sh gr
/Times-Roman ff 200.00 scf sf
2925 3975 m
gs 1 -1 sc (sndbuf) col0 sh gr
/Times-Roman ff 200.00 scf sf
8775 3975 m
gs 1 -1 sc (rcvbuf) col0 sh gr
% here ends figure;
$F2psEnd
rs
showpage
%%EndDocument
end PEND/F1 13/Times-Roman@0 SF(Ho)33.336 285.444 Q(we)-.325 E -.195(ve)
-.325 G 6.102(ru).195 G(nlik)-6.102 E 6.102(ep)-.13 G 2.852
(ipes which are contained in a single host, data in)-6.102 F -.26(vo)
-.52 G(lv).26 E 2.851(ed in a TCP)-.195 F
(connection can be in one of three places:)33.336 300.444 Q 3.25<8342>
33.336 315.444 S(uf)-3.25 E(fered by the k)-.325 E
(ernel on the sending side)-.13 E 3.25<8349>33.336 330.444 S 3.25(nt)
-3.25 G(ransit o)-3.25 E -.195(ve)-.195 G 3.25(rt).195 G(he netw)-3.25 E
(ork)-.13 E 3.25<8342>33.336 345.444 S(uf)-3.25 E(fered by the k)-.325 E
(ernel on the recei)-.13 E(ving side)-.325 E .206(The reliability of TC\
P means that on the sending side, copies of the data must be retained)
33.336 366.444 R 1.34(in the send b)33.336 381.444 R(uf)-.26 E 1.34
(fer until those bytes ha)-.325 F 1.73 -.195(ve b)-.26 H 1.34(een recei)
.195 F -.195(ve)-.325 G 4.59(da).195 G 4.59(tt)-4.59 G 1.34(he f)-4.59 F
1.339(ar end \(as pro)-.13 F -.195(ve)-.195 G 4.589(db).195 G 4.589(yt)
-4.589 G(he)-4.589 E .332(receipt of A)33.336 396.444 R .332
(CK messages\).)-.52 F(Lik)6.832 E -.325(ew)-.13 G .332
(ise at the recei).325 F .333(ving end, the k)-.325 F .333(ernel must b)
-.13 F(uf)-.26 E .333(fer the data)-.325 F(until the user)33.336 411.444
Q(-le)-.26 E -.195(ve)-.325 G 3.25(lp).195 G(rogram reads it.)-3.25 E
.243(Data transfer o)33.336 432.444 R -.195(ve)-.195 G 3.493(raT).195 G
.242(CP connection can be accomplished with the normal read and write)
-3.493 F 2.698(systems calls.)33.336 447.444 R 2.698
(Since TCP does not preserv)9.198 F 5.949(em)-.195 G 2.699
(essage boundaries, a read will simply)-5.949 F .814
(return all currently queued data sitting in the recei)33.336 462.444 R
1.204 -.195(ve b)-.325 H(uf)-.065 E(fer)-.325 E 4.064(,i)-.52 G .814
(gnoring an)-4.064 F 4.064(yt)-.195 G .814(he boundaries)-4.064 F 2.17
(with which the data were originally sent.)33.336 477.444 R 2.17
(Reading from a TCP connection is akin to)8.67 F .849
(reading from a pipe.)33.336 492.444 R .848
(The read system call will block until the f)7.349 F .848
(ar end writes some data,)-.13 F .728(and then will return with whate)
33.336 507.444 R -.195(ve)-.325 G 3.978(rd).195 G .728(ata are a)-3.978
F -.325(va)-.26 G 3.978(ilable. When).325 F .728
(the remote side shuts do)3.978 F(wn)-.325 E 1.872(the connection in th\
at direction, read returns an EOF \(after all queued data ha)33.336
522.444 R 2.262 -.195(ve b)-.26 H(een).195 E(read\).)33.336 537.444 Q
3.226 -1.04(We c)33.336 558.444 T 1.147(an look at the lifetime of each\
 half of a TCP connection as being a stream of data)1.04 F 3.604
(identi\214ed by sequence numbers.)33.336 573.444 R 5.683 -1.04(We c)
10.103 H 3.603(an further cate)1.04 F 3.603
(gorize parts of that stream as)-.195 F(depicted belo)33.336 588.444 Q
(w:)-.325 E 0 Cg EP
%%Page: 14 14
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 14)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E 0 0 468 717 -150.778 231 33.336 270.778 PBEGIN
%%BeginDocument: tcpseq.eps
%!PS-Adobe-2.0 EPSF-2.0
%%Title: tcpseq.fig
%%Creator: fig2dev Version 3.2 Patchlevel 4
%%CreationDate: Wed Mar  9 18:47:25 2011
%%For: hak@lex ()
%%BoundingBox: 0 0 717 231
%%Magnification: 1.0000
%%EndComments
/$F2psDict 200 dict def
$F2psDict begin
$F2psDict /mtrx matrix put
/col-1 {0 setgray} bind def
/col0 {0.000 0.000 0.000 srgb} bind def
/col1 {0.000 0.000 1.000 srgb} bind def
/col2 {0.000 1.000 0.000 srgb} bind def
/col3 {0.000 1.000 1.000 srgb} bind def
/col4 {1.000 0.000 0.000 srgb} bind def
/col5 {1.000 0.000 1.000 srgb} bind def
/col6 {1.000 1.000 0.000 srgb} bind def
/col7 {1.000 1.000 1.000 srgb} bind def
/col8 {0.000 0.000 0.560 srgb} bind def
/col9 {0.000 0.000 0.690 srgb} bind def
/col10 {0.000 0.000 0.820 srgb} bind def
/col11 {0.530 0.810 1.000 srgb} bind def
/col12 {0.000 0.560 0.000 srgb} bind def
/col13 {0.000 0.690 0.000 srgb} bind def
/col14 {0.000 0.820 0.000 srgb} bind def
/col15 {0.000 0.560 0.560 srgb} bind def
/col16 {0.000 0.690 0.690 srgb} bind def
/col17 {0.000 0.820 0.820 srgb} bind def
/col18 {0.560 0.000 0.000 srgb} bind def
/col19 {0.690 0.000 0.000 srgb} bind def
/col20 {0.820 0.000 0.000 srgb} bind def
/col21 {0.560 0.000 0.560 srgb} bind def
/col22 {0.690 0.000 0.690 srgb} bind def
/col23 {0.820 0.000 0.820 srgb} bind def
/col24 {0.500 0.190 0.000 srgb} bind def
/col25 {0.630 0.250 0.000 srgb} bind def
/col26 {0.750 0.380 0.000 srgb} bind def
/col27 {1.000 0.500 0.500 srgb} bind def
/col28 {1.000 0.630 0.630 srgb} bind def
/col29 {1.000 0.750 0.750 srgb} bind def
/col30 {1.000 0.880 0.880 srgb} bind def
/col31 {1.000 0.840 0.000 srgb} bind def

end
save
newpath 0 231 moveto 0 0 lineto 717 0 lineto 717 231 lineto closepath clip newpath
-108.0 320.2 translate
1 -1 scale

/cp {closepath} bind def
/ef {eofill} bind def
/gr {grestore} bind def
/gs {gsave} bind def
/sa {save} bind def
/rs {restore} bind def
/l {lineto} bind def
/m {moveto} bind def
/rm {rmoveto} bind def
/n {newpath} bind def
/s {stroke} bind def
/sh {show} bind def
/slc {setlinecap} bind def
/slj {setlinejoin} bind def
/slw {setlinewidth} bind def
/srgb {setrgbcolor} bind def
/rot {rotate} bind def
/sc {scale} bind def
/sd {setdash} bind def
/ff {findfont} bind def
/sf {setfont} bind def
/scf {scalefont} bind def
/sw {stringwidth} bind def
/tr {translate} bind def
/tnt {dup dup currentrgbcolor
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add
  4 -2 roll dup 1 exch sub 3 -1 roll mul add srgb}
  bind def
/shd {dup dup currentrgbcolor 4 -2 roll mul 4 -2 roll mul
  4 -2 roll mul srgb} bind def
/reencdict 12 dict def /ReEncode { reencdict begin
/newcodesandnames exch def /newfontname exch def /basefontname exch def
/basefontdict basefontname findfont def /newfont basefontdict maxlength dict def
basefontdict { exch dup /FID ne { dup /Encoding eq
{ exch dup length array copy newfont 3 1 roll put }
{ exch newfont 3 1 roll put } ifelse } { pop pop } ifelse } forall
newfont /FontName newfontname put newcodesandnames aload pop
128 1 255 { newfont /Encoding get exch /.notdef put } for
newcodesandnames length 2 idiv { newfont /Encoding get 3 1 roll put } repeat
newfontname newfont definefont pop end } def
/isovec [
8#055 /minus 8#200 /grave 8#201 /acute 8#202 /circumflex 8#203 /tilde
8#204 /macron 8#205 /breve 8#206 /dotaccent 8#207 /dieresis
8#210 /ring 8#211 /cedilla 8#212 /hungarumlaut 8#213 /ogonek 8#214 /caron
8#220 /dotlessi 8#230 /oe 8#231 /OE
8#240 /space 8#241 /exclamdown 8#242 /cent 8#243 /sterling
8#244 /currency 8#245 /yen 8#246 /brokenbar 8#247 /section 8#250 /dieresis
8#251 /copyright 8#252 /ordfeminine 8#253 /guillemotleft 8#254 /logicalnot
8#255 /hyphen 8#256 /registered 8#257 /macron 8#260 /degree 8#261 /plusminus
8#262 /twosuperior 8#263 /threesuperior 8#264 /acute 8#265 /mu 8#266 /paragraph
8#267 /periodcentered 8#270 /cedilla 8#271 /onesuperior 8#272 /ordmasculine
8#273 /guillemotright 8#274 /onequarter 8#275 /onehalf
8#276 /threequarters 8#277 /questiondown 8#300 /Agrave 8#301 /Aacute
8#302 /Acircumflex 8#303 /Atilde 8#304 /Adieresis 8#305 /Aring
8#306 /AE 8#307 /Ccedilla 8#310 /Egrave 8#311 /Eacute
8#312 /Ecircumflex 8#313 /Edieresis 8#314 /Igrave 8#315 /Iacute
8#316 /Icircumflex 8#317 /Idieresis 8#320 /Eth 8#321 /Ntilde 8#322 /Ograve
8#323 /Oacute 8#324 /Ocircumflex 8#325 /Otilde 8#326 /Odieresis 8#327 /multiply
8#330 /Oslash 8#331 /Ugrave 8#332 /Uacute 8#333 /Ucircumflex
8#334 /Udieresis 8#335 /Yacute 8#336 /Thorn 8#337 /germandbls 8#340 /agrave
8#341 /aacute 8#342 /acircumflex 8#343 /atilde 8#344 /adieresis 8#345 /aring
8#346 /ae 8#347 /ccedilla 8#350 /egrave 8#351 /eacute
8#352 /ecircumflex 8#353 /edieresis 8#354 /igrave 8#355 /iacute
8#356 /icircumflex 8#357 /idieresis 8#360 /eth 8#361 /ntilde 8#362 /ograve
8#363 /oacute 8#364 /ocircumflex 8#365 /otilde 8#366 /odieresis 8#367 /divide
8#370 /oslash 8#371 /ugrave 8#372 /uacute 8#373 /ucircumflex
8#374 /udieresis 8#375 /yacute 8#376 /thorn 8#377 /ydieresis] def
/Times-Roman /Times-Roman-iso isovec ReEncode
/$F2psBegin {$F2psDict begin /$F2psEnteredState save def} def
/$F2psEnd {$F2psEnteredState restore end} def

$F2psBegin
10 setmiterlimit
0 slj 0 slc
 0.06000 0.06000 sc
%
% Fig objects follow
%
% 
% here starts figure with depth 50
/Times-Roman-iso ff 200.00 scf sf
13500 3000 m
gs 1 -1 sc (F) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
13500 3255 m
gs 1 -1 sc (I) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
13500 3510 m
gs 1 -1 sc (N) col0 sh gr
% Polyline
7.500 slw
gs  clippath
2221 2642 m 2281 2637 l 2268 2486 l 2249 2609 l 2209 2491 l cp
eoclip
n 2175 1725 m
 2250 2625 l gs col0 s gr gr

% arrowhead
n 2209 2491 m 2249 2609 l 2268 2486 l  col0 s
% Polyline
n 5475 2700 m
 5475 3750 l gs col0 s gr 
% Polyline
n 7950 2700 m
 7950 3750 l gs col0 s gr 
% Polyline
n 10275 2700 m
 10275 3750 l gs col0 s gr 
% Polyline
n 2175 2700 m 13725 2700 l 13725 3750 l 2175 3750 l
 cp gs col0 s gr 
% Polyline
n 13425 2700 m
 13425 3750 l gs col0 s gr 
% Polyline
n 12450 2700 m
 12450 3750 l gs col0 s gr 
% Polyline
 [60] 0 sd
n 5475 3900 m
 5475 5325 l gs col0 s gr  [] 0 sd
% Polyline
 [60] 0 sd
n 12450 3900 m
 12450 5325 l gs col0 s gr  [] 0 sd
% Polyline
gs  clippath
5460 5070 m 5460 5130 l 5612 5130 l 5492 5100 l 5612 5070 l cp
eoclip
n 7725 5100 m
 5475 5100 l gs col0 s gr gr

% arrowhead
n 5612 5070 m 5492 5100 l 5612 5130 l  col0 s
% Polyline
gs  clippath
12465 5130 m 12465 5070 l 12313 5070 l 12433 5100 l 12313 5130 l cp
eoclip
n 12450 5100 m
 10350 5100 l gs col0 s gr gr

% arrowhead
n 12313 5130 m 12433 5100 l 12313 5070 l  col0 s
% Polyline
gs  clippath
13558 2600 m 13592 2550 l 13465 2466 l 13549 2558 l 13432 2516 l cp
eoclip
n 12663 1967 m
 13563 2567 l gs col0 s gr gr

% arrowhead
n 13432 2516 m 13549 2558 l 13465 2466 l  col0 s
% Polyline
 [60] 0 sd
n 8025 3750 m
 8025 4350 l gs col0 s gr  [] 0 sd
% Polyline
gs  clippath
12465 4305 m 12465 4245 l 12313 4245 l 12433 4275 l 12313 4305 l cp
eoclip
n 12450 4275 m
 10650 4275 l gs col0 s gr gr

% arrowhead
n 12313 4305 m 12433 4275 l 12313 4245 l  col0 s
% Polyline
gs  clippath
8160 4245 m 8160 4305 l 8312 4305 l 8192 4275 l 8312 4245 l cp
eoclip
n 8775 4275 m
 8175 4275 l gs col0 s gr gr

% arrowhead
n 8312 4245 m 8192 4275 l 8312 4305 l  col0 s
% Polyline
gs  clippath
10404 2651 m 10458 2625 l 10391 2489 l 10418 2610 l 10337 2516 l cp
eoclip
n 10125 2025 m
 10425 2625 l gs col0 s gr gr

% arrowhead
n 10337 2516 m 10418 2610 l 10391 2489 l  col0 s
% Polyline
gs  clippath
8079 2726 m 8133 2700 l 8066 2564 l 8093 2685 l 8012 2591 l cp
eoclip
n 7800 2100 m
 8100 2700 l gs col0 s gr gr

% arrowhead
n 8012 2591 m 8093 2685 l 8066 2564 l  col0 s
/Times-Roman-iso ff 200.00 scf sf
1800 1650 m
gs 1 -1 sc (Initial Seq #) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
2775 3375 m
gs 1 -1 sc (remote process) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
2700 3075 m
gs 1 -1 sc (ACK'd and read by) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
5625 3000 m
gs 1 -1 sc (ACK'd, in remote ) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
5625 3255 m
gs 1 -1 sc ( buffer awaiting read) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
8250 2925 m
gs 1 -1 sc (un-ACK'd data) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
8250 3180 m
gs 1 -1 sc (\(in transit or lost\)) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
8250 3435 m
gs 1 -1 sc (Held in buffer on) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
8250 3690 m
gs 1 -1 sc (local side) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
10425 2850 m
gs 1 -1 sc (Additional data which) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
10425 3105 m
gs 1 -1 sc (may be sent before) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
10425 3360 m
gs 1 -1 sc (writer is blocked on) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
10425 3615 m
gs 1 -1 sc (flow control) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
12600 2925 m
gs 1 -1 sc (Future) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
12600 3180 m
gs 1 -1 sc (Data) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
8175 5025 m
gs 1 -1 sc (Total remote buffer) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
8550 5325 m
gs 1 -1 sc (size limit) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
11550 1875 m
gs 1 -1 sc (Final Seq #) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
9150 4380 m
gs 1 -1 sc (current value) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
9225 4125 m
gs 1 -1 sc (TCP "WIN") col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
12525 3450 m
gs 1 -1 sc (\(Blocked\)) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
9150 1950 m
gs 1 -1 sc (Next Seq #) col0 sh gr
/Times-Roman-iso ff 200.00 scf sf
6900 2100 m
gs 1 -1 sc (Last ACK #) col0 sh gr
% here ends figure;
$F2psEnd
rs
showpage
%%EndDocument
end PEND/F1 13/Times-Roman@0 SF 1.193(The send b)33.336 297.778 R(uf)
-.26 E 1.193(fer and recei)-.325 F 1.583 -.195(ve b)-.325 H(uf)-.065 E
1.193(fer are of \214nite size, typically less than 64K.)-.325 F(Lik)
7.694 E -.325(ew)-.13 G(ise,).325 E 1.835
(TCP messages that are in transit are taking up b)33.336 312.778 R(uf)
-.26 E 1.835(fer resources in the netw)-.325 F 1.834(ork, so the)-.13 F
1.271
(protocol desires to limit the total amount of data in transit \(ag)
33.336 327.778 R 1.272(ain typically under 64K\).)-.065 F .36
(When the sender is too f)33.336 342.778 R .36
(ast, either because the recei)-.13 F -.195(ve)-.325 G 3.609(ri).195 G
3.609(ss)-3.609 G(lo)-3.609 E 2.049 -.845(w, o)-.325 H 3.609(rt).845 G
.359(he netw)-3.609 F .359(ork is slo)-.13 F 2.049 -.845(w, o)-.325 H(r)
.845 E(both, \215o)33.336 357.778 Q 3.25(wc)-.325 G(ontrol eng)-3.25 E
(ages to k)-.065 E(eep things in balance.)-.13 E 3.737
(The remote side will adv)33.336 378.778 R 3.737(ertise a WINdo)-.195 F
6.987(ww)-.325 G 3.737(ith each A)-6.987 F 3.737(CK, relati)-.52 F 4.127
-.195(ve t)-.325 H 6.987(ot).195 G 3.737(he highest)-6.987 F 1.226
(sequence number it has A)33.336 393.778 R(CK')-.52 E 1.226
(d, such that its recei)-.65 F 1.616 -.195(ve b)-.325 H(uf)-.065 E 1.225
(fer will not be o)-.325 F -.195(ve)-.195 G(r\215o).195 E 4.475(wed. On)
-.325 F .755
(the local side, when a process attempts to write data which w)33.336
408.778 R .755(ould e)-.13 F .755(xceed the windo)-.195 F 2.445 -.845
(w, i)-.325 H(t).845 E 1.007(blocks until the remote side mo)33.336
423.778 R -.195(ve)-.195 G 4.257(st).195 G 1.007(he windo)-4.257 F 5.947
-.845(w. I)-.325 H 4.256(fn).845 G(etw)-4.256 E 1.006
(ork throughput is slo)-.13 F 2.696 -.845(w, t)-.325 H 1.006(he data)
.845 F .275(which are "in transit" will gro)33.336 438.778 R 3.525(wu)
-.325 G .276(ntil the the)-3.525 F 3.526<798c>-.195 G .276(ll the windo)
-3.526 F 1.966 -.845(w, a)-.325 H .276(lso eng).845 F .276(aging \215o)
-.065 F 3.526(wc)-.325 G(ontrol.)-3.526 E 1.065
(It is possible for "short writes" to occur when writing to a TCP sock)
33.336 459.778 R 1.064(et if the number of)-.13 F .516
(bytes which the process is attempting to write e)33.336 474.778 R .516
(xceeds the windo)-.195 F 3.767(ws)-.325 G 3.767(ize. The)-3.767 F -.13
(ke)3.767 G .517(rnel may).13 F 2.399(write whate)33.336 489.778 R -.195
(ve)-.325 G 5.649(rb).195 G 2.399(ytes \214t, and return a short write \
count, or it may block the process,)-5.649 F(depending on the k)33.336
504.778 Q(ernel v)-.13 E(ersion.)-.195 E 0 Cg EP
%%Page: 15 15
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 15)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Bold@0 SF(Sending and r)164.239 120 Q(ecei)-.234 E
(ving UDP messages)-.13 E/F2 13/Times-Roman@0 SF -.195(Fo)33.336 150 S
3.991(rU).195 G(DP)-3.991 E(,)-1.443 E/F3 13/Times-Italic@0 SF(sendto)
3.991 E F2(and)3.991 E F3 -.481(re)3.991 G(cvfr).481 E(om)-.585 E F2
.741(are used for data transfer)3.991 F 7.241(.S)-.715 G .741
(ince UDP is a connectionless)-7.241 F .155(protocol, the destination a\
ddress and port number must be speci\214ed with each transmitted)33.336
165 R(message:)33.336 180 Q/F4 10/Courier@0 SF(int sendto\(int sockfd,)
33.336 192 Q(char *msg,)90.936 204 Q(int msglen,)90.936 216 Q
(int flags,)90.936 228 Q(struct sockaddr *to,)90.936 240 Q(int tolen\))
90.936 252 Q F3<8d61>33.336 273 Q(gs)-.13 E F2 .696(is normally left 0.)
3.946 F .697(If a UDP sock)7.197 F .697(et has been)-.13 F F3(connect)
3.947 E F2 .697(ed, the destination address for)B
(all messages sent on that sock)33.336 288 Q(et is set.)-.13 E F3(send)
6.5 E F2(can then be used, ommitting the address:)3.25 E F4
(send\(sockfd,msg,msglen,flags\))33.336 300 Q F2 2.08 -1.04(To r)33.336
336 T(ecei)1.04 E .39 -.195(ve a m)-.325 H(essage:).195 E F4
(int recvfrom\(int sockfd,)33.336 348 Q(char *buf,)90.936 360 Q
(int buflen,)90.936 372 Q(int flags,)90.936 384 Q
(struct sockaddr *from,)90.936 396 Q(int *fromlen\))90.936 408 Q/F5 13
/Courier@0 SF(recvfrom)33.336 429 Q F2 .495
(will block until a message is a)3.745 F -.325(va)-.26 G 3.745
(ilable. The).325 F(ne)3.745 E .495(xt message is placed into)-.195 F F3
-.26(bu)3.744 G(f).26 E F2(.)A .819(If the message o)33.336 444 R -.195
(ve)-.195 G(r\215o).195 E(ws)-.325 E F3 -.26(bu)4.069 G(\215en).26 E F2
4.069(,e)C .819(xcess bytes are discarded for UDP sock)-4.264 F(ets.)
-.13 E F3(fr)7.319 E(omlen)-.585 E F2(is)4.069 E -.325(va)33.336 459 S
1.076(lue-result parameter which is set to the length of).325 F F3(fr)
4.326 E(om)-.585 E F2 4.326(,a)C 1.075
(nd is \214lled in with the actual)-4.326 F 1.742
(length on return, just lik)33.336 474 R(e)-.13 E F5(accept)4.992 E F2
8.242(.T)C 1.742(he address placed in)-8.242 F F3(fr)4.992 E(om)-.585 E
F2 1.742(is the remote address)4.992 F(associated with the recie)33.336
489 Q -.195(ve)-.325 G 3.25(dm).195 G(essage.)-3.25 E 4.345
(If a UDP sock)33.336 510 R 4.344(et is)-.13 F F5(connect)7.594 E F2
4.344(ed, then only messages from the connected remote)B
(address/port# will be recei)33.336 525 Q -.195(ve)-.325 G(d, and).195 E
F5(recv)3.25 E F2(can be used instead:)3.25 E F4
(recv\(sockfd,buf,buflen,flags\))33.336 537 Q F1(Closing a connection)
209.915 567 Q F2 .487(UDP is a connectionless protocol \(ne)33.336 603 R
-.195(ve)-.325 G .487(rmind the f).195 F(ak)-.13 E .487(ery of)-.13 F F5
(connect)3.737 E F2 .487(on a UDP sock)3.737 F(et\),)-.13 E .646
(so there is no notion of establishing and tearing do)33.336 618 R .645
(wn a connection.)-.325 F(The)7.145 E F5(close)3.895 E F2(system)3.895 E
.336(call on a UDP sock)33.336 633 R .336(et simply releases the sock)
-.13 F .337(et and \214le descriptor back into the resource)-.13 F
(pool, and discards an)33.336 648 Q 3.25(yp)-.195 G
(ending, unread messages.)-3.25 E -.52(Wi)33.336 669 S .988(th TCP).52 F
4.238(,o)-1.443 G 4.237(nt)-4.238 G .987
(he other hand, the connection is a pair of one-w)-4.237 F .987
(ay pipes.)-.13 F .987(Each direction)7.487 F(can be shut do)33.336 684
Q(wn independently)-.325 E(.)-.845 E F5(shutdown)33.336 705 Q F2
(closes one or both directions of a connected sock)3.25 E(et:)-.13 E F4
(int shutdown\(socket,how\))33.336 717 Q F2(If)33.336 732 Q F3(how)3.94
E F2 .69(is 0, the recei)3.94 F 1.08 -.195(ve d)-.325 H .69
(irection is shut do).195 F 3.94(wn. If)-.325 F F3(how)3.941 E F2 .691
(is 1, the transmit direction is shut)3.941 F 0 Cg EP
%%Page: 16 16
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 16)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Roman@0 SF(do)33.336 120 Q 3.25(wn. If)-.325 F/F2 13
/Times-Italic@0 SF(how)3.25 E F1(is 2, both directions are closed.)3.25
E .194(When the transmit side is shut do)33.336 141 R .194
(wn, the remote end will recei)-.325 F .584 -.195(ve a)-.325 H 3.444(ne)
.195 G .194(nd-of-\214le indication)-3.444 F .323
(when it has read all remaining data.)33.336 156 R(An)6.823 E 3.573(yd)
-.195 G .323(ata that ha)-3.573 F .714 -.195(ve b)-.26 H .324
(een sent b).195 F .324(ut not yet recei)-.26 F -.195(ve)-.325 G 3.574
(db).195 G(y)-3.574 E(the remote end remain queued until read.)33.336
171 Q 3.239(When the recei)33.336 192 R 3.239(ving side is shut do)-.325
F 3.239(wn, an)-.325 F 6.489(yp)-.195 G 3.239
(ending unread data are discarded.)-6.489 F(An)9.739 E .031
(attempt by the remote system to write to the sock)33.336 207 R .032
(et which has either been shutdo)-.13 F .032(wn in the)-.325 F 2.097
(write direction locally)33.336 222 R 5.347(,o)-.845 G 5.347(ri)-5.347 G
5.346(nt)-5.347 G 2.096(he read direction at the f)-5.346 F 2.096
(ar end, will result in EPIPE or)-.13 F(deli)33.336 237 Q -.195(ve)-.325
G(ry of SIGPIPE, just as is the case with local pipes.).195 E 1.566
(When a TCP sock)33.336 258 R 1.566(et is closed, either with an e)-.13
F(xplicit)-.195 E/F3 13/Courier@0 SF(close)4.816 E F1 1.566
(system call or at process)4.816 F -.195(ex)33.336 273 S 1.876
(it, both directions are also closed do).195 F 1.875(wn, as if)-.325 F
F3(shutdown\(s,2\))5.125 E F1 1.875(had been in)5.125 F -.26(vo)-.52 G
-.13(ke).26 G(d.).13 E(An)33.336 288 Q 3.592(yd)-.195 G .342
(ata which are queued to be transmitted at the netw)-3.592 F .343
(ork layer are)-.13 F/F4 13/Times-Bold@0 SF(not)3.593 E F1 3.593
(discarded. The)3.593 F .027(TCP connection continues to e)33.336 303 R
.027(xist e)-.195 F -.195(ve)-.325 G 3.277(na).195 G .027
(fter the close.)-3.277 F(Ho)6.527 E(we)-.325 E -.195(ve)-.325 G 1.067
-.52(r, i).195 H 3.277(ft).52 G .027(hose queued data are)-3.277 F 4.442
(ultimately not deli)33.336 318 R -.195(ve)-.325 G 4.442
(rable, that error status w).195 F 4.442(ould be lost.)-.13 F 4.442
(An option can be set)10.942 F .556(\(SO_LINGER\) using the)33.336 333 R
F3(setsockopt)3.806 E F1 .556(system call which will force the)3.806 F
F3(close)3.805 E F1 .555(to w)3.805 F(ait)-.13 E 1.999
(until all queued data are successfully transmitted to the f)33.336 348
R 2(ar end.)-.13 F -.195(Fo)8.5 G 5.25(rt).195 G 2(his reason, it is)
-5.25 F(important to check the return v)33.336 363 Q(alue from close.)
-.325 E F4(Using the DNS)226.529 408 Q F1 1.869(Because 32 bit inte)
33.336 444 R 1.869
(gers are not terribly mnemonic host names, the Internet pro)-.195 F
1.869(vides a)-.195 F(distrib)33.336 459 Q 4.511(uted database called t\
he Domain Name System \(DNS\) to translate between)-.26 F
(numeric IP addresses and hierarchical, te)33.336 474 Q
(xtual names, such as)-.195 E F3(cooper.edu)3.25 E F1(.)A 3.839
(This mapping is potentially man)33.336 495 R(y-to-man)-.195 E 8.778
-.845(y. W)-.195 H 3.838(hile the case of a single IP address).845 F
2.302(equating to a single hostname is the most common, there are frequ\
ent cases where a)33.336 510 R(single name has multiple IP addresses, o\
r a single IP address has multiple names.)33.336 525 Q 6.779(UNIX pro)
33.336 546 R 6.778
(vides standard library routines to query the Domain Name System.)-.195
F F3(gethostbyname)33.336 561 Q F1(tak)10.429 E 7.18
(es a domain name and returns a list of IP addresses:)-.13 F F3
(gethostbyaddr)33.336 576 Q F1 .423(performs the re)3.674 F -.195(ve)
-.325 G .423(rse operation, taking an IP adddress and returning a).195 F
.356(list of names.)33.336 591 R .356
(Both are not re-entrant safe, in that the)6.856 F 3.606(yr)-.195 G .357
(eturn a pointer to static data \(and)-3.606 F(furthermore the underlyi\
ng structure contains further pointers to static data\).)33.336 606 Q/F5
12/Courier@0 SF(#include <netdb.h>)33.336 621 Q(extern int h_errno;)
33.336 636 Q(struct hostent *gethostbyname\(const char *name\);)33.336
666 Q(struct hostent *gethostbyaddr\(const char *addr,)33.336 696 Q
(int len, int type\);)105.336 711 Q(struct hostent {)33.336 741 Q 0 Cg
EP
%%Page: 17 17
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 17)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 12/Courier@0 SF 21.6(char *h_name;)76.536 120 R
(/* official name of host */)57.6 E 21.6(char **h_aliases; /*)76.536 135
R(alias list */)7.2 E 28.8(int h_addrtype; /*)76.536 150 R
(host address type */)7.2 E 28.8(int h_length;)76.536 165 R
(/* length of address */)50.4 E 21.6(char **h_addr_list;)76.536 180 R
(/* list of addresses */)14.4 E(})33.336 195 Q(#define h_addr)33.336 210
Q 7.2(h_addr_list[0] /*)14.4 F(for backward compatibility */)7.2 E/F2 13
/Times-Roman@0 SF -.195(Fo)33.336 231 S 3.374(rs).195 G(implicity)-3.374
E(,)-.845 E/F3 13/Courier@0 SF(h_name)3.374 E F2(and)3.374 E F3(h_addr)
3.374 E F2 .124(can be used by applications which don')3.374 F 3.374(tc)
-.234 G .124(are about)-3.374 F(the possible e)33.336 246 Q
(xistence of multiple names or addresses.)-.195 E 0 Cg EP
%%Page: 18 18
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 18)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Roman@0 SF 3.734
(In addition, some utility functions are a)33.336 120 R -.325(va)-.26 G
3.735(ilable to con).325 F -.195(ve)-.52 G 3.735
(rt between dotted decimal).195 F
(notation \(e.g. 10.1.2.3\) and an unsigned long:)33.336 135 Q/F2 12
/Courier@0 SF(#include <sys/socket.h>)33.336 150 Q
(#include <netinet/in.h>)33.336 165 Q(#include <arpa/inet.h>)33.336 180
Q(int inet_aton\(const char *cp, struct in_addr *inp\);)33.336 210 Q
(unsigned long int inet_addr\(const char *cp\);)33.336 240 Q
(char *inet_ntoa\(struct in_addr in\);)33.336 270 Q/F3 13/Courier@0 SF
(inet_addr)33.336 291 Q F1 3.964
(parses a dotted-decimal string and returns an unsigned long \(32 bit\))
7.214 F 1.225(address, already in netw)33.336 306 R 1.225
(ork byte order)-.13 F 7.726(.I)-.715 G 4.476(ft)-7.726 G 1.226
(he string is not parseable, the all-ones v)-4.476 F(alue)-.325 E .786
(\(-1\) is returned.)33.336 321 R .786
(This is 255.255.255.255 in dotted quad notation, which is ne)7.286 F
-.195(ve)-.325 G 4.035(rav).195 G(alid)-4.36 E 1.224(host address.)
33.336 336 R(Ho)7.724 E(we)-.325 E -.195(ve)-.325 G 2.264 -.52(r, i).195
H 4.474(td).52 G 1.224
(oes represent the broadcast address which is used in certain)-4.474 F
.494(system applications and thus)33.336 351 R/F4 13/Times-Italic@0 SF
(inet_addr)3.744 E F1(is)3.744 E/F5 13/Times-Bold@0 SF(unclean)3.744 E
F1(.)A F4(inet_aton)6.994 E F1 .494(is preferred although some)3.744 F
.229(older UNIX v)33.336 366 R .229(ariants do not support it.)-.325 F
.23(It returns zero on f)6.73 F .23(ailure and non-zero on success.)-.13
F(Here')33.336 381 Q 3.25(sa)-.715 G 3.25(ne)-3.25 G
(xample of looking up a name:)-3.445 E/F6 10/Courier@0 SF(f\(nm\))33.336
393 Q(char *nm;)33.336 405 Q({)33.336 417 Q(struct hostent *he;)39.336
429 Q(struct sockaddr_in sin;)39.336 441 Q
(if \(\(sin.sin_addr.s_addr=inet_addr\(nm\)\)== -1\))75.336 453 Q({)
81.336 465 Q(if \(!\(he=gethostbyname\(nm\)\)\))129.336 477 Q({)129.336
489 Q(fprintf\(stderr,"Unknown host:%s",nm\);)177.336 501 Q
(herror\(" "\);)206.136 513 Q(return -1;)177.336 525 Q(})129.336 537 Q
(memcpy\(&sin.sin_addr.s_addr,he->h_addr_list[0],)129.336 549 Q
(sizeof sin.sin_addr.s_addr\);)206.136 561 Q(})81.336 573 Q F1 .363
(The Domain Name System has its o)33.336 609 R .363
(wn set of error codes, which are distinct from system)-.325 F 5.318
(call error codes.)33.336 624 R 5.318
(These codes can distinguish, for e)11.818 F 5.319(xample, between a ne)
-.195 F -.065(ga)-.195 G(ti).065 E -.195(ve)-.325 G .234
(con\214rmation \(requested name or address de\214nitely doesn')33.336
639 R 3.484(te)-.234 G .234(xist\) and a system f)-3.679 F .234
(ailure \(no)-.13 F .016(answer could be determined at this time\).)
33.336 654 R F3(herror)3.266 E F1 .016
(prints a symbolic representation of the)3.266 F
(error code of the last f)33.336 669 Q(ailed DNS operation.)-.13 E .589
(Recent UNIX distrib)33.336 690 R .589(utions ha)-.26 F .979 -.195
(ve a n)-.26 H 1.239 -.325(ew i).195 H(nterf).325 E .588(ace called)-.13
F F3(getaddrinfo)3.838 E F1 3.838(,a)C .588(nd declare that)-3.838 F
1.109(functions such as)33.336 705 R F3(gethostbyname)4.359 E F1 1.109
(are obsolescent.)4.359 F 1.11(Programmers should be)7.609 F -.13(wa)
-.325 G 1.11(re that).13 F 1.41(sometimes using the f)33.336 720 R(anc)
-.13 E 4.659(yn)-.195 G 2.059 -.325(ew f)-4.659 H 1.409(unction mak).325
F 1.409(es it dif)-.13 F 1.409(\214cult to get your code to w)-.325 F
1.409(ork on)-.13 F(older systems.)33.336 735 Q 0 Cg EP
%%Page: 19 19
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 19)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Bold@0 SF(Handling multiple sock)164.48 120 Q
(ets with select)-.13 E/F2 13/Times-Roman@0 SF 1.552
(Read and write operations on sock)33.336 156 R 1.553
(ets may block, which causes problems for programs)-.13 F 5.376
(which need to simultaneously communicate on multiple sock)33.336 171 R
8.625(ets. There)-.13 F 5.375(are tw)8.625 F(o)-.13 E 1.054(approaches \
to solving this: using a multi-threaded program, and using non-blocking\
 I/O)33.336 186 R(in conjunction with the)33.336 201 Q/F3 13/Courier@0
SF(select)3.25 E F2(system call.)3.25 E 2.08 -1.04(We w)6.5 H
(ill not discuss threads in this unit.)1.04 E 2.08 -1.04(To p)33.336 222
T(ut a sock)1.04 E(et \(or an)-.13 E 3.25(yo)-.195 G
(ther \214le descriptor\) into non-blocking mode, use)-3.25 E F3(fcntl)
3.25 E F2(:)A/F4 10/Courier@0 SF(s=socket\(....\))90.936 234 Q
(/* connect, etc. */)90.936 246 Q
(if \(fcntl\(s,F_SETFL,O_NONBLOCK\)<0\) perror\("fcntl"\);)90.936 258 Q
(n=read\(s,buf,sizeof buf\);)90.936 270 Q(if \(n<0\))90.936 282 Q({)
90.936 294 Q(if \(errno==EWOULDBLOCK\) /*it's ok */)148.536 306 Q
(else perror\("socket read"\);)148.536 318 Q(})90.936 330 Q F2(No)33.336
351 Q 4.644(ww)-.325 G 4.644(ec)-4.644 G 1.393(an use)-4.644 F F3(read)
4.643 E F2(,)A F3(write)4.643 E F2(,)A F3(recvfrom)A F2(and)4.643 E F3
(sendto)4.643 E F2 1.393(without fear of our program)4.643 F .335
(becoming "stuck" in a blocking operation.)33.336 366 R .335
(The system call will just f)6.835 F .335(ail temporarily with)-.13 F
1.302(an error of)33.336 381 R F3(EWOULDBLOCK)4.552 E F2 7.802(.\()C
1.302(In some UNIX v)-7.802 F(ariants,)-.325 E F3(EAGAIN)4.552 E F2
1.302(is the error code\).)4.552 F -1.04(We)7.802 G .387(can try ag)
33.336 396 R 3.637(ain. Ho)-.065 F(we)-.325 E -.195(ve)-.325 G 1.427
-.52(r, t).195 H .388(his is only half the battle.).52 F .388
(If we were to write a program which)6.888 F 6.929(just k)33.336 411 R
6.929
(eeps on banging on the operation in a tight loop when it encounters)
-.13 F F3(EWOULDBLOCK)33.336 426 Q F2 4.617(,t)C 1.367(his w)-4.617 F
1.368(ould be what is kno)-.13 F 1.368(wn as a "spin loop" or "b)-.325 F
(usy-w)-.26 E 1.368(ait" loop.)-.13 F(It)7.868 E -.13(wo)33.336 441 S
3.492(uld mean that the program is consuming v).13 F 3.491
(ast amounts of user and cpu time to)-.325 F .492(accomplish nothing.)
33.336 456 R .492(What we need is a w)6.992 F .492(ay of blocking and k)
-.13 F .493(eeping an e)-.13 F .493(ye on multiple)-.195 F
(\214le descriptors at once.)33.336 471 Q(The)33.336 492 Q F3(select)
4.745 E F2 1.495(system call can be used to monitor an)4.745 F 4.745(yn)
-.195 G 1.495(umber of \214le descriptors to see)-4.745 F 1.397
(when reading or writing operations w)33.336 507 R 1.397
(ould succeed \(at least partially\) without blocking.)-.13 F
(The syntax is some)33.336 522 Q(what a)-.325 E(wkw)-.195 E(ard:)-.13 E
F4(/* Read man page on select for some discussion of new vs old)33.336
534 Q(ways of getting the right header files.)51.336 546 Q(*/)12 E
(#include <sys/types.h>)33.336 558 Q(#include <unistd.h>)33.336 570 Q
(#include <sys/select.h>)33.336 582 Q(main\(\))33.336 618 Q({)33.336 630
Q(int s1,s2,maxfd;)39.336 642 Q(fd_set readfds,writefds;)39.336 654 Q
(/* open sockets s1 and s2, connect, etc. */)90.936 666 Q
(if \(s1>s2\) maxfd=s1; else maxfd=s2;)90.936 678 Q(if \(fcntl\(s1,F_SE\
TFL,O_NONBLOCK\)<0\) {perror\("fcntl s1"\);return -1;})90.936 690 Q(if \
\(fcntl\(s2,F_SETFL,O_NONBLOCK\)<0\) {perror\("fcntl s2"\);return -1;})
90.936 702 Q(for\(;;\))90.936 714 Q({)90.936 726 Q(FD_ZERO\(&readfds\);)
148.536 738 Q 0 Cg EP
%%Page: 20 20
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 20)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 10/Courier@0 SF(FD_ZERO\(&writefds\);)148.536 117 Q
(FD_SET\(s1,&readfds\);)148.536 129 Q(FD_SET\(s2,&writefds\);)148.536
141 Q(if \(select\(maxfd+1,&readfds,&writefds,NULL,NULL\)<0\))148.536
153 Q({)148.536 165 Q(perror\("select error"\);)206.136 177 Q
(return -1;)206.136 189 Q(})148.536 201 Q(if \(FD_ISSET\(s1,&readfs\)\))
148.536 213 Q({)148.536 225 Q(while \(\(n=read\(s1,...\)\)\)>0)206.136
237 Q(// should read something)12 E(/*...*/)263.736 249 Q(})148.536 261
Q(if \(FD_ISSET\(s2,&writefds\)\))148.536 273 Q({)148.536 285 Q
(while \(\(n=write\(s2,...\)\)>0\) // should write at least 1 byte)
206.136 297 Q(/*...*/)263.736 309 Q(})148.536 321 Q(})90.936 333 Q/F2 13
/Times-Roman@0 SF(The)33.336 354 Q/F3 13/Courier@0 SF(select)3.667 E F2
.417(system call operates on bit v)3.667 F .417
(ectors which represent a set of \214le descriptors.)-.195 F 2.702
(The mechanics of manipulating these bit v)33.336 369 R 2.702
(ectors are best left to the macros such as)-.195 F F3(FD_SET)33.336 384
Q F2 4.879(which are pro)8.129 F 4.878(vided by the include \214les.)
-.195 F 4.878(The second, third and fourth)11.378 F .148(parameters to)
33.336 399 R F3(select)3.398 E F2 .148(are pointers to these bit v)3.398
F 3.399(ectors. The)-.195 F 3.399(ya)-.195 G .149
(re each \214le descriptor sets)-3.399 F .294
(that we are "interested in".)33.336 414 R .294(The second ar)6.794 F
.294(gument represents \214le descriptors for which we)-.234 F -.13(wa)
33.336 429 S .169(nt to monitor read-ready e).13 F -.195(ve)-.325 G .17
(nts, the ne).195 F .17(xt is a similar set for write-ready e)-.195 F
-.195(ve)-.325 G .17(nts, and the).195 F .058(last is described as "e)
33.336 444 R .058(xception e)-.195 F -.195(ve)-.325 G 3.308(nts". That')
.195 F 3.308(sh)-.715 G .708 -.325(ow t)-3.308 H .058
(he man page describes the sets, b).325 F .058(ut to)-.26 F
(be more precise, at least with respect to Linux 2.6 k)33.336 459 Q
(ernel:)-.13 E 4.52(\203A")33.336 474 S 1.27(read-ready" e)-4.52 F -.195
(ve)-.325 G 1.27(nt is an).195 F 4.52(yo)-.195 G 4.52(ft)-4.52 G 1.27
(he follo)-4.52 F 1.27(wing: at least one byte of data a)-.325 F -.325
(va)-.26 G 1.271(ilable to be).325 F .802(read; there has been an end-o\
f-\214le condition \(including remote end of sock)33.336 489 R .801
(et connection)-.13 F(has closed\); there has been an error posted ag)
33.336 504 Q(ainst the \214le descriptor)-.065 E(.)-.715 E 3.89(\203A")
33.336 519 S .64(write-ready" e)-3.89 F -.195(ve)-.325 G .64(nt is an)
.195 F 3.89(yo)-.195 G 3.89(ft)-3.89 G .64(he follo)-3.89 F .64
(wing: At least one byte of data may be written)-.325 F
(without blocking; there has been an error posted ag)33.336 534 Q
(ainst the \214le descriptor)-.065 E(.)-.715 E 4.24<8354>33.336 549 S
.99(he "e)-4.24 F .99(xception" e)-.195 F -.195(ve)-.325 G .99
(nt is only used for an obscure sock).195 F .99
(ets programming feature called)-.13 F("out-of-band" or "ur)33.336 564 Q
(gent" data deli)-.234 E -.195(ve)-.325 G(ry).195 E 3.25(,a)-.845 G
(nd will not be discussed further here.)-3.25 E .882(The \214rst ar)
33.336 585 R .882(gument to)-.234 F F3(select)4.132 E F2 .882
(is the highest \214le descriptor number set in)4.132 F/F4 13
/Times-Bold@0 SF(any)4.133 E F2 .883(of the bit)4.133 F -.195(ve)33.336
600 S .745(ctors being passed in,).195 F F4 .745(plus one)3.995 F F2
7.245(.A)C .745(nother w)-7.245 F .744
(ay of looking at it is: the maximum length)-.13 F .534(of the bit v)
33.336 615 R 3.784(ectors. This)-.195 F .534
(is a problematic part of the API.)3.784 F .535
(While one could just set this to)7.035 F 3.948(some rather lar)33.336
630 R 3.948(ge number \(there are v)-.234 F 3.948(arious w)-.325 F 3.947
(ays, some static, some run-time, of)-.13 F .171(querying the maximum n\
umber of open \214les\), doing so imposes a performance penalty in)
33.336 645 R 2.542(the k)33.336 660 R 2.542(ernel, which must e)-.13 F
2.542(xamine each of the passed v)-.195 F 2.542
(ectors to the limit that the \214rst)-.195 F(ar)33.336 675 Q .385
(gument gi)-.234 F -.195(ve)-.325 G 3.635(s. Man).195 F 3.635(yp)-.195 G
.386(rogrammers write utilities to front-end select and manage the bit)
-3.635 F -.195(ve)33.336 690 S(ctors so as to k).195 E
(eep track of the highest \214le descriptor number)-.13 E(.)-.715 E .803
(The \214fth ar)33.336 711 R .803(gument to)-.234 F F3(select)4.053 E F2
.803(is a timeout.)4.053 F .803(It is represented by a pointer to a)
7.303 F F3(struct)4.052 E(timeval)33.336 726 Q F2 4.292(,w)C 1.042
(hich gi)-4.292 F -.195(ve)-.325 G 4.292(sb).195 G 1.042
(oth seconds and microseconds.)-4.292 F 1.042(If the ar)7.542 F 1.042
(gument is)-.234 F F3(NULL)4.293 E F2 4.293(,t)C(hen)-4.293 E .694
(there is no timeout and select blocks until one or more of the e)33.336
741 R -.195(ve)-.325 G .693(nts we are interested in).195 F 0 Cg EP
%%Page: 21 21
%%BeginPageSetup
BP
%%EndPageSetup
/F0 9/Times-Roman@0 SF(ECE357:Computer Operating Systems)33.336 60 Q
(Unit 6/pg 21)71.748 E(\2512013 Jef)142.155 E 2.25(fH)-.225 G(akner)
-2.25 E/F1 13/Times-Roman@0 SF(arri)33.336 120 Q -.195(ve)-.325 G 5.312
(s. The).195 F/F2 13/Courier@0 SF 2.062(struct timeval)5.312 F F1 2.062
(may be set with both elements zero, in which case)5.312 F F2(select)
33.336 135 Q F1(returns immediately)3.25 E(.)-.845 E 1.491
(Upon return from select, the bit v)33.336 156 R 1.49
(ectors which were passed as pointers are modi\214ed to)-.195 F 2.284
(re\215ect which \214le descriptors had the corresponding e)33.336 171 R
-.195(ve)-.325 G 2.285(nts pending.).195 F 2.285(The return v)8.785 F
(alue)-.325 E 4.374
(from select is the total number of bits which are set in all three v)
33.336 186 R 7.624(ectors. Most)-.195 F 2.584(programmers do not mak)
33.336 201 R 5.834(eu)-.13 G 2.584(se of this number e)-5.834 F 2.584
(xcept to detect error \(-1 return\), and)-.195 F 1.03(instead, kno)
33.336 216 R 1.029(wing which \214le descriptors were re)-.325 F 1.029
(gistered going in, query the result v)-.195 F(ector)-.195 E .513
(and act accordingly)33.336 231 R 7.013(.S)-.845 G .513(ince the v)
-7.013 F .513(ectors are o)-.195 F -.195(ve)-.195 G -.26(r-).195 G .513
(written by the k).26 F .513(ernel, it is often useful to)-.13 F(mak)
33.336 246 Q 3.25(eab)-.13 G(ackup cop)-3.25 E -.845(y.)-.13 G/F3 13
/Times-Bold@0 SF(poll system call)225.086 276 Q F2(select)33.336 312 Q
F1 2.113(is a potentially trick)5.363 F 5.363(yi)-.195 G(nterf)-5.363 E
2.113(ace to use, and man)-.13 F 5.363(yp)-.195 G 2.113
(rogrammers prefer to use)-5.363 F 4.603(threads. Ho)33.336 327 R(we)
-.325 E -.195(ve)-.325 G 2.393 -.52(r, m).195 H 1.353
(ulti-threaded programming has its o).52 F 1.353(wn sets of pitf)-.325 F
1.354(alls and gotchas)-.13 F 5.605(too. There)33.336 342 R 2.355
(is another system call)5.605 F F2(poll)5.605 E F1 2.355
(which performs essentially the same task as)5.605 F F2(select)33.336
357 Q F1 5.793(,b)C 2.543(ut with a dif)-6.053 F 2.543(ferent interf)
-.325 F 5.793(ace. In)-.13 F(man)5.793 E 5.793(yw)-.195 G 2.544
(ays it is a superior interf)-5.923 F 2.544(ace, b)-.13 F(ut)-.26 E .5
(because historically)33.336 372 R F2(poll)3.75 E F1 -.13(wa)3.75 G 3.75
(sn).13 G .5(ot a)-3.75 F -.325(va)-.26 G .5(ilable on man).325 F 3.75
(yU)-.195 G .5(NIX v)-3.75 F .5(ariants, most programmers)-.325 F(gra)
33.336 387 Q 3.053(vitate to)-.26 F -.13(wa)-.325 G(rds).13 E F2(select)
6.303 E F1 9.553(.T)C 3.054(he e)-9.553 F 3.054(xample belo)-.195 F
6.304(ws)-.325 G 3.054(hould be self-e)-6.304 F 3.054
(xplanatory with the)-.195 F(assistance of the man page for poll\(2\).)
33.336 402 Q/F4 10/Courier@0 SF(struct pollfd pollarry[3];)33.336 414 Q
(pollarry[0].fd=fd_readsocket;)90.936 426 Q(pollarry[0].events=POLLIN;)
90.936 438 Q(pollarry[1].fd=fd_writesocket;)90.936 450 Q
(pollarry[1].events=POLLOUT;)90.936 462 Q
(pollarry[2].fd=fd_controlsocket;)90.936 474 Q
(pollarry[2].events=POLLIN|POLLOUT|POLLERR;)90.936 486 Q
(if \(poll\(&pollfd,3,-1\)<0\))90.936 498 Q(perror\("poll"\);)148.536
510 Q(else)90.936 522 Q({)90.936 534 Q
(if \(pollarry[0].revents&POLLIN\))148.536 546 Q
(do_read\(pollarry[0].fd\);)206.136 558 Q(//etc.)148.536 570 Q(})90.936
582 Q 0 Cg EP
%%Trailer
end
%%EOF
